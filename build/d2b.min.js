!function(t,e,n){"use strict";function r(t,e){if("undefined"==typeof document)return e;t=t||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t)),n.appendChild(r),e}function a(t){return"function"==typeof t?t:function(){return t}}function o(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0];return e.forEach(function(t){null!==r&&void 0!==r&&r!==!1||(r=t)}),r}function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.label},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"start";n=a(n),t.each(function(t,a){var l=e.select(this),d=(""+n.call(this,t,a)).split(/\s+/).reverse(),c=void 0,u=[],s=[d.pop()],p=1.1,b=+l.attr("x"),h=+l.attr("y"),f=parseFloat(l.attr("dy"))||0;for(o(l.html(),"").indexOf("tspan")===-1&&l.text(""),c=d.pop();c;)s.join(" ").length+c.length>r&&(u.push(s),s=[]),s.push(c),c=d.pop();u.push(s);var g=l.selectAll("tspan").data(u),y=(u.length-1)*p,v="end"===i?y:"middle"===i?y/2:0;g.merge(g.enter().append("tspan")).text(function(t){return t.join(" ")}).attr("x",b).attr("y",h).attr("dy",function(t,e){return f+e*p-v+"em"})})}function l(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;t.each(function(){var t=e.select(this),r=t.text().split(/\s+/).reverse(),a=void 0,o=[],i=0,l=1.1,d=parseFloat(t.attr("y"))||0,c=parseFloat(t.attr("dy"))||0,u=t.text(null).append("tspan").attr("x",0).attr("y",d).attr("dy",c+"em");for(a=r.pop();a;)o.push(a),u.text(o.join(" ")),u.node().getComputedTextLength()>n&&(o.pop(),u.text(o.join(" ")),o=[a],u=t.append("tspan").attr("x",0).attr("y",d).attr("dy",++i*l+c+"em").text(a)),a=r.pop()})}function d(t,n){function r(t){return{innerRadius:n.innerRadius()(t),outerRadius:n.outerRadius()(t),startAngle:n.startAngle()(t),endAngle:n.endAngle()(t)}}return t.selection?void t.attrTween("d",function(t){var a=this;t=r(t),this.current=this.current||t;var o=e.interpolate(this.current,t);return function(t){return a.current=o(t),n(a.current)}}):t.attr("d",function(t){return this.current=r(t),n(t)})}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return isNaN(t)||null===t?e:t}function u(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t};return n=a(n),t.selection?void t.tween("text",function(t,a){var o=this,i=c(n.call(this,t,a));this.current=c(this.current,i);var l=e.interpolate(this.current,i);return function(t){o.textContent=r(o.current=l(t))}}):t.text(function(t,e){return this.current=c(n.call(this,t,e)),r(this.current)})}function s(t,n){function r(t){return{innerRadius:n.innerRadius()(t),outerRadius:n.outerRadius()(t),startAngle:n.startAngle()(t),endAngle:n.endAngle()(t),rotate:o(t)||0}}var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.rotate};return o=a(o),t.selection?void t.attrTween("transform",function(t){var a=this;t=r(t),this.current=this.current||t;var o=e.interpolate(this.current,t);return function(t){return a.current=o(t),"translate("+n.centroid(a.current)+") "+("rotate("+(a.current.rotate||0)+")")}}):t.attr("transform",function(t){return this.current=r(t),"translate("+n.centroid(this.current)+")"+("rotate("+this.current.rotate+")")})}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2],i=function(e,n){return function(a){if(!arguments.length)return r[e];var o=r[e];return r[e]=a,n&&n(a,o),t}},l=function(t){return function(){return r[t]}},d=function(e,n){return function(o){if(!arguments.length)return r[e];var i=r[e];return r[e]=a(o),n&&n(r[e],i),t}},c=function(e,n){return function(o){if(!arguments.length)return r[e];var i=r[e];return o&&o.domain?r[e]=function(){return o}:r[e]=a(o),n&&n(r[e],i),t}},u={base:function(){return t},values:function(){return r},removeProp:function(e){return o.indexOf(e)!==-1?u:(r[e]=null,t[e]=null,u)},addProp:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i(e),o=arguments[3];return r[e]||t[e]?u:(a=a||i(e,o),a(n),t[e]=a,u)},addPropGet:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l(e);return r[e]||t[e]?u:(r[e]=n,t[e]=a,u)},addMethod:function(e,n){return t[e]?u:(t[e]=n,u)},addPropFunctor:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(e),o=arguments[3];return r[e]||t[e]?u:(a=a||d(e,o),a(n),t[e]=a,u)},addScaleFunctor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c(t),r=arguments[3];return u.addProp(t,e,n,r)},addDispatcher:function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"on",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"dispatch";return t[o]?u:r[i]?u:(t[o]=function(e,n){return 0===arguments.length?r[i]:1===arguments.length?r[i].on(e):(r[i].on(e,n),t)},r[i]=e.dispatch.apply(n,a),u)}};return u}function b(){var t={},n=function t(e){var n=e.selection?e.selection():e;return n.on(l("mouseover"),a).on(l("mouseout"),i),U()?n.on(l("click"),i):n.on(l("mousemove"),o),t},r=function(n,r){var a=this.getBoundingClientRect(),o={},i=(t.at.call(this,n,r)||(e.event.clientX>window.innerWidth/2?"center left":"center right")).split(" ");switch(i={x:i[1],y:i[0]},i.x){case"left":o.x=a.left;break;case"center":o.x=a.left+a.width/2;break;default:o.x=a.left+a.width}switch(i.y){case"bottom":o.y=a.top+a.height;break;case"center":o.y=a.top+a.height/2;break;default:o.y=a.top}return o},a=function(e,n){var r=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),a=r.enter().append("div").style("opacity",0).attr("class","d2b-tooltip");a.append("div").attr("class","d2b-tooltip-content"),r=r.merge(a),r.transition().duration(100).style("opacity",1),t.dispatch.call("insert",r,this,e,n),o.call(this,e,n)},o=function(n,a){var o=t.html.call(this,n,a),i=t.target.call(this,n,a),l=t.color.call(this,n,a),d=i?i.node():this,c=t.followMouse.call(this,n,a)?{x:e.event.clientX,y:e.event.clientY}:r.call(d,n,a),u=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),s=t.my.call(this,n,a)||(e.event.clientX>window.innerWidth/2?"left":"right");u.attr("class","d2b-tooltip d2b-tooltip-"+s).style("top",c.y+"px").style("left",c.x+"px").style("border-color",l).select(".d2b-tooltip-content").html(o),t.dispatch.call("move",u,this,n,a)},i=function(e,n){var r=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]});r.transition().duration(100).style("opacity",0).remove(),t.dispatch.call("remove",r,this,e,n)},l=function(t){return t+".d2b-tooltip"};return p(n,t).addProp("container",e.select("body")).addMethod("clear",function(t){return(t.selection?t.selection():t).on(l("mouseover"),null).on(l("mouseout"),null).on(l("mousemove"),null),n}).addPropFunctor("followMouse",!1).addPropFunctor("color",null).addPropFunctor("my",null).addPropFunctor("at",null).addPropFunctor("target",null).addPropFunctor("html",null).addDispatcher(["insert","move","remove"]),n}function h(){var t={},n={},r=function(e,n,r){if("y"===r){if(n.y===1/0)return e.style("opacity",0);e.style("opacity",1).attr("transform","translate(0, "+n.y+")").attr("y1",0).attr("y2",0).attr("x1",0).attr("x2",t.size.width)}else{if(n.x===1/0)return e.style("opacity",0);e.style("opacity",1).attr("transform","translate("+n.x+", 0)").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",t.size.height)}},a=function(n,r,a){var o=n.node();if(o){var i=n.node().getBoundingClientRect(),l=a.x,d=a.y,c=10;t.trackY?d+=r.y>t.size.height/2?r.y-c-i.height:r.y+c:d=e.event.clientY-a.y>t.size.height/2?e.event.clientY-c-i.height:e.event.clientY+c,t.trackX?l+=r.x>t.size.width/2?r.x-c-i.width:r.x+c:l=e.event.clientX-a.x>t.size.width/2?e.event.clientX-c-i.width:e.event.clientX+c,l+=window.pageXOffset,d+=window.pageYOffset,n.style("left",l+"px").style("top",d+"px")}},i=function(e,n){var r=t.title(n.points.map(function(t){return t.data}));e.select(".d2b-tooltip-title").style("display",r?"block":"none").html(r);var a=e.select(".d2b-tooltip-content"),o=a.selectAll(".d2b-tooltip-row").data(n.points),i=o.enter().append("div").attr("class","d2b-tooltip-row");o.exit().remove(),o=o.merge(i).html(function(t){return t.row}).style("border-left-color",function(t){return t.color||"transparent"})},l=function(n){var r={x:e.event.clientX-n.x,y:e.event.clientY-n.y},a=1/0,i=1/0,l=[];for(var d in y)if(y.hasOwnProperty(d)){var c=y[d],u=function(e){if(!c.hasOwnProperty(e))return"continue";var n=c[e],d=[];n.config.data.forEach(function(e,c){var u={data:e,x:o(n.config.x(e,c),t.x(e,c)),y:o(n.config.y(e,c),t.y(e,c)),color:o(n.config.color(e,c),t.color(e,c)),row:o(n.config.row(e,c),t.row(e,c))};if(t.trackX&&t.trackY){if(u.x===a&&u.y===i)return d.push(u);var s=Math.sqrt(Math.pow(a-r.x,2)+Math.pow(i-r.y,2)),p=Math.sqrt(Math.pow(u.x-r.x,2)+Math.pow(u.y-r.y,2));p<s&&p<t.threshold&&(a=u.x,i=u.y,l=[],d=[u])}else if(t.trackX){if(u.x===a)return d.push(u);var b=Math.abs(a-r.x),h=Math.abs(u.x-r.x);h<b&&h<t.threshold&&(a=u.x,l=[],d=[u])}else if(t.trackY){if(u.y===i)return d.push(u);var f=Math.abs(i-r.y),g=Math.abs(u.y-r.y);g<f&&g<t.threshold&&(i=u.y,l=[],d=[u])}}),l=l.concat(d)};for(var s in c){u(s)}}return l=l.sort(function(t,n){return e.ascending(t.x,n.x)||e.ascending(t.y,n.y)}),{x:a,y:i,points:l}},d=function(t){t.transition().duration(50).style("opacity",0).remove()},c=function(t){t.transition().duration(50).style("opacity",1)},u=function(e,r){var a=t.svgContainer.selectAll(".d2b-tooltip-marker-x").data(t.trackX?[n]:[]),o=a.enter().append("line").attr("class","d2b-tooltip-marker-x d2b-tooltip-marker"),i=t.svgContainer.selectAll(".d2b-tooltip-marker-y").data(t.trackY?[n]:[]),l=i.enter().append("line").attr("class","d2b-tooltip-marker-y d2b-tooltip-marker"),d=t.htmlContainer.selectAll(".d2b-tooltip").data([n]),u=d.enter().append("div").attr("class","d2b-tooltip d2b-tooltip-axis");u.merge(d).call(c),i.merge(l).call(c),a.merge(o).call(c),u.append("div").attr("class","d2b-tooltip-title"),u.append("div").attr("class","d2b-tooltip-content"),t.dispatch.call("insert",t.tooltip,e,r)},s=function(){t.svgContainer.selectAll(".d2b-tooltip-marker-x").data([]).exit().call(d),t.svgContainer.selectAll(".d2b-tooltip-marker-y").data([]).exit().call(d),t.htmlContainer.selectAll(".d2b-tooltip").data([]).exit().call(d)},b=function(e,n){var o=t.svgContainer.selectAll(".d2b-tooltip-base").data([e]);o=o.merge(o.enter().append("rect").attr("class","d2b-tooltip-base"));var d=o.node().getBoundingClientRect();d={x:d.left,y:d.top};var c=l(d);return c.points.length?(u(),t.svgContainer.select(".d2b-tooltip-marker-x").call(r,c,"x"),t.svgContainer.select(".d2b-tooltip-marker-y").call(r,c,"y"),t.htmlContainer.select(".d2b-tooltip").call(i,c).call(a,c,d),void t.dispatch.call("move",t.tooltip,e,n)):s()},h=function(e,n){s(),t.dispatch.call("remove",t.tooltip,e,n)},f=function(t){return t+".d2b-tooltip-axis"},g=function(t,e){e&&e.on(f("mouseout"),null).on(f("mousemove"),null),t&&t.on(f("mouseout"),h).on(f("mousemove"),b)};p(n,t).addProp("htmlContainer",e.select("body")).addProp("svgContainer",null).addProp("tracker",e.select("body"),null,g).addProp("size",{height:0,width:0}).addProp("trackX",!0).addProp("trackY",!1).addProp("threshold",1/0).addMethod("clear",function(t,e){return 0===arguments.length?y={}:1===arguments.length?delete y[t]:arguments.length>=2&&delete y[t][e],n}).addPropFunctor("title",null).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("color",null).addPropFunctor("row",null).addDispatcher(["move","insert","remove"]);var y={};return n.graph=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=y[t]=y[t]||{},r=n[e];if(!r){r=n[e]={interface:{},config:{}};var a=p(r.interface,r.config);a.addProp("data",[]).addMethod("clear",function(){return r.config.data=[],r.interface}).addMethod("addPoint",function(t){return r.config.data.push(t),r.interface}).addPropFunctor("x",null).addPropFunctor("y",null).addPropFunctor("color",null).addPropFunctor("row",null)}return r.interface},n}function f(){var t={},n=function(n){var r=this,a=n;n=n.map(t.values);var o=[],i=n.map(function(e){var n={};return e.forEach(function(e,a){var i=t.x.call(r,e,a);o.push(i),n[i]=t.y.call(r,e,a)}),n});o=e.set(o).values();var l=o.reduce(function(t,e,n){return t[e]=n,t},{}),d=e.range(0,n.length),c=o.map(function(t){return i.map(function(e){return e[t]||0})});t.stack.keys(d).value(function(t,e){return t[e]||0});var u=t.stack(c);return n.forEach(function(e,n){e.forEach(function(e,a){var o=t.x.call(r,e,a),i=u[n][l[o]];t.out.call(r,e,i[0],i[1],o)})}),a};return p(n,t).addProp("stack",e.stack()).addPropFunctor("values",function(t){return t}).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addProp("out",function(t,e,n){t.y0=e,t.y1=n}),n}function g(){var t={},e=function e(n){var r=n.selection?n.selection():n,a=r.selectAll(".d2b-breadcrumbs").data(function(t){return[t]}),o=a.enter().append("div").attr("class","d2b-breadcrumbs");a=a.merge(o).classed("d2b-vertical",t.vertical);var i=a.selectAll(".d2b-breadcrumb").data(t.values,t.key),l=i.exit(),d=i.enter().append("div").attr("class","d2b-breadcrumb").style("opacity",0);return d.append("div").attr("class","d2b-breadcrumb-icon"),d.append("div").attr("class","d2b-breadcrumb-content"),i=i.merge(d).order(),i.select(".d2b-breadcrumb-content").html(t.html),n!==r&&(i=i.transition(n),l=l.transition(n).style("opacity",0)),i.style("border-color",t.color).style("opacity",1).select(".d2b-breadcrumb-icon").style("background-color",t.color),l.remove(),r.dispatch("breadcrumbs-updated",{bubbles:!0}),e};return p(e,t).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,e){return e}).addPropFunctor("color","blue").addPropFunctor("html",function(t){return t.html}).addPropFunctor("vertical",!0),e}function y(){var t={},n=e.symbol().size(80),r=function r(a){var o=a.selection?a.selection():a,i=o.selectAll(".d2b-legend").data(function(t){return[t]}),l=i.enter().append("div").attr("class","d2b-legend");i=i.merge(l).classed("d2b-vertical",t.vertical);var d=i.selectAll(".d2b-legend-item").data(t.values,t.key),c=d.exit(),u=d.enter().append("div").attr("class","d2b-legend-item").style("opacity",0);u.append("div").attr("class","d2b-legend-icon"),u.append("div").attr("class","d2b-legend-content"),d=d.merge(u).order(),d.select(".d2b-legend-content").html(t.html),a!==o&&(d=d.transition(a),c=c.transition(a).style("opacity",0)),d.style("opacity",1).each(function(r,a){var o=e.select(this),i=t.color(r,a),l=t.empty(r,a);o.style("border-color",i);var d=t.icon(r,a),c=o.select(".d2b-legend-icon"),u=[],s=[],p=c.node().getBoundingClientRect(),b={width:p.width,height:p.height},h={x:b.width/2,y:b.height/2};"string"==typeof d?u.push(d):s.push(d);var f=c.selectAll(".d2b-legend-svg-icon").data(function(t){return[t]}),g=f.enter().append("svg");g.attr("class","d2b-legend-svg-icon").attr("width",b.width).attr("height",b.height),f=f.merge(g);var y=f.selectAll("text").data(u),v=y.enter().append("text");y.exit().remove(),v.append("tspan"),y=y.merge(v),y.style("stroke",i).style("fill",l?"white":i).attr("transform","translate("+h.x+","+1.65*h.y+")").select("tspan").text(function(t){return t});var m=f.selectAll("path").data(s);m.exit().remove(),m=m.merge(m.enter().append("path")),m.style("stroke",i).style("fill",l?"white":i).attr("d",function(t){return n.type(t)()}).attr("transform","translate("+h.x+","+h.y+")")}),i.each(function(n,a){var i=t.allowEmptied(n,a),l=e.select(this).selectAll(".d2b-legend-item"),d=function(e){l.each(function(n,r){t.setEmpty(n,r,e)})},c=function e(){var e=!0;return l.each(function(n,r){t.empty(n,r)||(e=!1)}),e},u=function(n,a){t.setEmpty(n,a,!t.empty(n,a)),!i&&c()&&d(!1),o.call(r),e.select(this.parentNode).dispatch("change",{bubbles:!0})},s=function(n,a){d(!0),t.setEmpty(n,a,!1),o.call(r),e.select(this.parentNode).dispatch("change",{bubbles:!0})};l.each(function(n,r){var a=t.clickable(n,r),o=t.dblclickable(n,r);e.select(this).on("click",a?u:null).on("dblclick",o?s:null)})}),o.dispatch("legend-updated",{bubbles:!0}),c.remove()};return p(r,t).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,e){return e}).addPropFunctor("color",function(t){return W(t.html)}).addPropFunctor("html",function(t){return t.html}).addPropFunctor("icon","ï„‘").addPropFunctor("vertical",!1).addPropFunctor("allowEmptied",!1).addPropFunctor("clickable",!1).addPropFunctor("dblclickable",!1).addPropFunctor("empty",function(t){return t.empty}).addPropFunctor("setEmpty",function(t,e,n){return t.empty=n}),r}function v(){function t(t){var e={top:0,left:0,right:0,bottom:0};return"number"==typeof t?{top:t,left:t,right:t,bottom:t}:(["top","bottm","right","left"].forEach(function(n){t[n]&&e[n]==t[n]}),e)}function n(t,e){return{width:t&&t.width>0?t.width:e.width,height:t&&t.height>0?t.height:e.height}}function r(t,e,n){n(t),n(e)}function a(t,e,n,a,o,i){var l=t.node();if(l){n.style("top","").style("left","").style("right","").style("bottom","").style("width","").style("height","");var d=void 0;"right"===a||"left"===a?(t.classed("d2b-vertical",!0),d=l.getBoundingClientRect(),r(e,n,function(t){t.style(a,o[a]+"px").style("top",o.top+"px").style("height",i.height+"px")}),o[a]+=d.width,i.width-=d.width):"top"===a||"bottom"===a?(t.classed("d2b-vertical",!1),d=l.getBoundingClientRect(),r(e,n,function(t){t.style(a,o[a]+"px").style("left",o.left+"px").style("width",i.width+"px")}),o[a]+=d.height,i.height-=d.height):t.classed("d2b-vertical",!1)}}var o={},i=function i(l){var d=l.selection?l.selection():l,c=d.selectAll(".d2b-chart-frame").data(function(t){return[t]}),u=c.enter().append("div").attr("class","d2b-chart-frame");return c=c.merge(u),d.each(function(i){var c=e.select(this).select(".d2b-chart-frame"),u=c,s=t(o.padding(i)),p=t(o.chartPadding(i)),b=n(o.size(i),this.getBoundingClientRect());r(c,u,function(t){t.style("width",b.width+"px").style("height",b.height+"px")}),b.width-=s.left+s.right,b.height-=s.top+s.bottom;var h=o.legendEnabled(i)?[i]:[],f=c.selectAll(".d2b-legend-frame").data(h),g=f.enter().append("div").attr("class","d2b-legend-frame"),y=f.exit();y.remove(),g.append("div").attr("class","d2b-legend-container"),f=f.merge(g);var v=f,m=o.breadcrumbsEnabled(i)?[i]:[],x=c.selectAll(".d2b-breadcrumbs-frame").data(m),k=x.enter().append("div").attr("class","d2b-breadcrumbs-frame"),P=x.exit();P.remove(),k.append("div").attr("class","d2b-breadcrumbs-container"),x=x.merge(k);var w=x,F=c.selectAll(".d2b-chart").data(function(t){return[t]}),_=F.enter().append("svg").attr("class","d2b-chart");_.append("g").attr("class","d2b-chart-container"),F=F.merge(_);var A=F;l!==d&&(u=u.transition(l),v=v.transition(l),w=w.transition(l),A=A.transition(l)),a(x,k,w,o.breadcrumbsOrient(i),s,b),a(f,g,v,o.legendOrient(i),s,b),r(_,A,function(t){t.style("left",s.left+"px").style("top",s.top+"px").style("width",b.width+"px").style("height",b.height+"px"),t.select(".d2b-chart-container").attr("transform","translate("+[p.left,p.top]+")")}),b.width-=p.left+p.right,b.height-=p.top+p.bottom,F.select(".d2b-chart-container").node().__size__=b}),d.dispatch("chart-frame-updated",{bubbles:!0}),i};return p(i,o).addPropFunctor("size",null).addPropFunctor("legendEnabled",!0).addPropFunctor("legendOrient","bottom").addPropFunctor("breadcrumbsEnabled",!1).addPropFunctor("breadcrumbsOrient","right").addPropFunctor("chartPadding",10).addPropFunctor("padding",10),i}function m(t,e){var n={};for(var r in t)"function"!=typeof t[r]&&e.indexOf(r)<0&&(n[r]=t[r]);return n}function x(t,e,n){var r=0,o=0;if(n=a(n||1),e=a(e||function(t){return t}),t.filter(function(t){return!isNaN(V(n(t)))&&!isNaN(V(e(t)))}).forEach(function(t){var a=n(t),i=e(t);r+=a,o+=i*a}),t.length&&r)return o/r}function k(t,n,r){r=a(r||1),n=a(n||function(t){return t});var o,i=[],l=t.filter(function(t){return 0!==r(t)&&!isNaN(V(r(t)))&&!isNaN(V(n(t)))}).sort(function(t,r){return e.ascending(n(t),n(r))});o=Math.round(e.sum(l,function(t){return r(t)})/2*1e12)/1e12;var d=0,c=!1;if(l.forEach(function(t){c&&(i.push(n(t)),c=!1),d+=r(t),d===o&&(i.push(n(t)),c=!0),d>o&&0===i.length&&i.push(n(t))}),t.length)return x(i)}function P(t,e,n){n=a(n||1),e=a(e||function(t){return t});var r=[],o=0,i={};return t.forEach(function(t){var a=V(e(t));isNaN(e(t))||(i[a]=i[a]||0,i[a]+=n(t),i[a]>o?(o=i[e(t)],r=[e(t)]):i[e(t)]==o&&r.push(e(t)))}),o<=1||!r.length?null:1===r.length?r[0]:r}function w(t,n){n=a(n||function(t){return t});var r=e.extent(t,n);if(t.length)return r[1]-r[0]}function F(t,n){if(n=a(n||function(t){return t}),t.length)return e.mean(e.extent(t,n))}function _(t){return t*(180/Math.PI)}function A(t){return t*(Math.PI/180)}function M(){function t(t,e){return l.empty.call(this,t,e)?0:1}function n(t,e){var n=l.size.call(this,t,e),r=l.empty.call(this,t,e);return c.size(r?n:2.5*n).call(this,t,e)}function r(t,e){var n=l.size.call(this,t,e),r=l.empty.call(this,t,e);return c.size(r?n/3:n).call(this,t,e)}function a(t,e){var n=l.size.call(this,t,e);return c.size(n).call(this,t,e)}function o(t,a){var o=l.empty.call(this,t,a);e.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",n),e.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",o?.5:1).attr("d",r)}function i(t,n){var o=l.empty.call(this,t,n);e.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",a),e.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",o?0:1).attr("d",r)}var l={},d=function n(d){var c=d.selection?d.selection():d,u=c.selectAll("path.d2b-point-back").data(function(t){return[t]});u.enter().append("path").attr("class","d2b-point-back").attr("d",a).style("fill-opacity",0).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),d!==c&&(u=u.transition(d)),u.attr("d",a).style("stroke",l.stroke).style("stroke-width",l.strokeWidth);var s=c.selectAll("path.d2b-point-front").data(function(t){return[t]});return s.enter().append("path").attr("class","d2b-point-front").attr("d",r).style("opacity",t).style("fill",l.fill).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),d!==c&&(s=s.transition(d)),s.attr("d",r).style("opacity",t).style("fill",l.fill).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),c.each(function(t,n){var r=l.active.call(this,t,n);e.select(this).on("mouseover.d2b-point",r?o:null).on("mouseout.d2b-point",r?i:null)}),c.dispatch("point-updated",{bubbles:!0}),n},c=e.symbol();return p(d,l).addPropFunctor("size",150,null,function(t){return c.size(t)}).addPropFunctor("type",e.symbolCircle,null,function(t){return c.type(t)}).addPropFunctor("active",!1).addPropFunctor("empty",!1).addPropFunctor("fill","steelblue").addPropFunctor("stroke",function(t,n){return e.rgb(l.fill.call(this,t,n)).darker(.3)}).addPropFunctor("strokeWidth","1px"),d}function z(){function t(t,e,a){var o=n(t,e,a),i=r(t,e,a);return o?{startAngle:o.endAngle,endAngle:o.endAngle}:i?{startAngle:i.startAngle,endAngle:i.startAngle}:{startAngle:0,endAngle:0}}function n(t,e,n){for(var r=e.length;--t>=0;)for(var o=a.key(n[t].data,t),i=0;i<r;++i)if(a.key(e[i].data,i)===o)return e[i]}function r(t,e,n){for(var r=n.length,o=e.length;++t<r;)for(var i=a.key(n[t].data,t),l=0;l<o;++l)if(a.key(e[l].data,l)===i)return e[l]}var a={},o=function n(r){var o=r.selection?r.selection():r;a.pie.value(a.value),a.arc.startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}).padAngle(function(t){return t.padAngle});var i=o.selectAll(".d2b-pie").data(function(t){return[a.pie(a.values(t))]}),l=i.enter().append("g").attr("class","d2b-pie");return i=i.merge(l),i.each(function(n){var i=e.select(this),l=i.selectAll(".d2b-pie-arc"),c=l.data();l=l.data(n,function(t,e){return t.key=a.key(t.data,e),t.key});var u=l.enter().append("g").attr("class","d2b-pie-arc"),s=l.exit(),p=l.merge(u).order();u.append("path").attr("fill",function(t,e){return a.color.call(this,t.data,e)});var b=p.data();u.select("path").each(function(e,n){this.current=t(n,c,b)}),s.datum(function(e,n){var r=t(n,b,c);return r.data=e.data,r.innerRadius=e.innerRadius,r.outerRadius=e.outerRadius,r}),r!==o&&(s=s.transition(r),p=p.transition(r)),p.select("path").call(d,a.arc).attr("fill",function(t,e){return a.color.call(this,t.data,e)}),s.remove().select("path").call(d,a.arc)}),o.dispatch("svg-pie-updated",{bubbles:!0}),n};return p(o,a).addProp("arc",e.arc()).addProp("pie",e.pie().sort(null)).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t){return t.label}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("color",function(t){return W(t.label)}),o}function E(t){return!(t.includes("NaN")||t.includes("Inifnity"))}function R(){function t(t,e){var r=n.graphs(t,e).map(function(t,e){var r={data:t,index:e,align:n.align(t,e),tooltipGraph:n.tooltipGraph(t,e),shift:n.shift(t,e),stackBy:n.stackBy(t,e),key:n.key(t,e),color:n.color(t,e)};return r.values=n.values(t,e).map(function(t,e){var a={data:t,index:e,graph:r,x:n.px(t,e),y:n.py(t,e)};return a.y1=a.y,a.y0=0,a}),r});return i.entries(r).forEach(function(t){return o(t.values)}),r}var n={},r=function e(r){var o=r.selection?r.selection():r,i=o.selectAll(".d2b-line-graphs").data(function(t){return[t]});i=i.merge(i.enter().append("g").attr("class","d2b-line-graphs"));var l=i.selectAll(".d2b-line-graph").data(function(e,n){return t(e,n)},function(t){return t.key}),d=l.enter().append("g").attr("class","d2b-line-graph d2b-graph").style("opacity",0);d.append("path").attr("class","d2b-line").style("stroke",function(t){return t.color}).attr("d",function(t){var e=this.parentNode.parentNode,r=e.__scaleX,o=e.__scaleY;return a.call(this,t,r||n.x,o||n.y)});var c=l.merge(d).order(),u=l.exit(),s=c.select(".d2b-line");r!==o&&(c=c.transition(r),u=u.transition(r),s=s.transition(r),u.style("opacity",0).select(".d2b-line").attr("d",function(t){return a.call(this,t,n.x,n.y)})),c.style("opacity",1),u.remove(),s.style("stroke",function(t){return t.color}).attr("d",function(t){return a.call(this,t,n.x,n.y,!0)});var p=n.x.copy(),b=n.y.copy();return i.each(function(){this.__scaleX=p,this.__scaleY=b}),o.dispatch("svg-line-updated",{bubbles:!0}),e},a=function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.shift;null===o&&(o=e.bandwidth?e.bandwidth()/2:0),t.tooltipGraph&&a&&t.tooltipGraph.data(t.values).x(function(t){return e(t.x)+o}).y(function(e){return r(e[t.align])}).color(t.color),n.line.x(function(t){return e(t.x)+o}).y(function(e){return r(e[t.align])});var i=n.line(t.values);return E(i)?i:this.getAttribute("d")},o=f().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),i=e.nest().key(function(t){var e=t.stackBy;return e!==!1&&null!==e?e:j()});return p(r,n).addProp("line",e.line()).addProp("stack",o.stack(),null,function(t){return o.stack(t)}).addProp("x",e.scaleLinear()).addProp("y",e.scaleLinear()).addPropGet("type","line").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addMethod("getComputedGraphs",function(e){return(e.selection?e.selection():e).data().map(function(e,n){return t(e,n)})}).addMethod("getVisiblePoints",function(t){var e=r.getComputedGraphs(t);return e.map(function(t){return[].concat.apply([],t.map(function(t){return t.values.map(function(e){return{x:e.x,y:e[t.align],graph:t}})}))})[0]}),r}function C(){function t(t,e){var r=n.graphs(t,e).map(function(t,e){var r={data:t,index:e,tooltipGraph:n.tooltipGraph(t,e),shift:n.shift(t,e),stackBy:n.stackBy(t,e),key:n.key(t,e),color:n.color(t,e)};return r.values=n.values(t,e).map(function(t,e){var a={data:t,index:e,graph:r,x:n.px(t,e),y:n.py(t,e)};return a.y1=a.y,a.y0=0,a}),r});return i.entries(r).forEach(function(t){return o(t.values)}),r}var n={},r=function e(r){var o=r.selection?r.selection():r,i=o.selectAll(".d2b-area-graphs").data(function(t){return[t]});i=i.merge(i.enter().append("g").attr("class","d2b-area-graphs"));var l=i.selectAll(".d2b-area-graph").data(function(e,n){return t(e,n)},function(t){return t.key}),d=l.enter().append("g").attr("class","d2b-area-graph d2b-graph").style("opacity",0);d.append("path").attr("class","d2b-area").style("fill",function(t){return t.color}).attr("d",function(t){var e=this.parentNode.parentNode,r=e.__scaleX,o=e.__scaleY;return a.call(this,t,r||n.x,o||n.y)});var c=l.merge(d).order(),u=l.exit(),s=c.select(".d2b-area");r!==o&&(c=c.transition(r),u=u.transition(r),s=s.transition(r),u.style("opacity",0).select(".d2b-area").attr("d",function(t){return a.call(this,t,n.x,n.y)})),c.style("opacity",1),u.remove(),s.style("fill",function(t){return t.color}).attr("d",function(t){return a.call(this,t,n.x,n.y,!0)});var p=n.x.copy(),b=n.y.copy();return i.each(function(){this.__scaleX=p,this.__scaleY=b}),o.dispatch("svg-area-updated",{bubbles:!0}),e},a=function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.shift;null===o&&(o=e.bandwidth?e.bandwidth()/2:0),t.tooltipGraph&&a&&t.tooltipGraph.data(t.values).x(function(t){return e(t.x)+o}).y(function(t){return r(t.y1)}).color(t.color),n.area.x(function(t){return e(t.x)+o}).y0(function(t){return r(t.y0)}).y1(function(t){return r(t.y1)});var i=n.area(t.values);return E(i)?i:this.getAttribute("d")},o=f().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),i=e.nest().key(function(t){var e=t.stackBy;return e!==!1&&null!==e?e:j()});return p(r,n).addProp("area",e.area()).addProp("stack",o.stack(),null,function(t){return o.stack(t)}).addProp("x",e.scaleLinear()).addProp("y",e.scaleLinear()).addPropGet("type","area").addPropFunctor("graphs",function(t){return t}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addMethod("getComputedGraphs",function(e){return(e.selection?e.selection():e).data().map(function(e,n){return t(e,n)})}).addMethod("getVisiblePoints",function(t){var e=r.getComputedGraphs(t);return e.map(function(t){var e=[].concat.apply([],t.map(function(t){return t.values.map(function(e){return{x:e.x,y:e.y0,graph:t}})})),n=[].concat.apply([],t.map(function(t){return t.values.map(function(e){return{x:e.x,y:e.y1,graph:t}})}));return e.concat(n)})[0]}),r}function G(){function t(t,e){var n=r.graphs(t,e).map(function(t,e){var n={data:t,index:e,align:r.align(t,e),tooltipGraph:r.tooltipGraph(t,e),shift:r.shift(t,e),stackBy:r.stackBy(t,e),key:r.key(t,e),color:r.color(t,e),symbol:r.symbol(t,e)};return n.values=r.values(t,e).map(function(t,e){var a={data:t,index:e,graph:n,x:r.px(t,e),y:r.py(t,e),color:r.pcolor(t,e),symbol:r.psymbol(t,e),key:r.pkey(t,e),size:r.psize(t,e)};return a.y1=a.y,a.y0=0,a}),n});return i.entries(n).forEach(function(t){return o(t.values)}),n}function n(t,e,n,r,a){t.attr("transform",function(t){var o=n(t[a]),i=e(t.x)+r;return isFinite(i)&&isFinite(o)?"translate("+[i,o]+")":this.getAttribute("transform");
})}var r={},a=function a(o){var i=o.selection?o.selection():o,l=i.selectAll(".d2b-scatter-graphs").data(function(t){return[t]});l=l.merge(l.enter().append("g").attr("class","d2b-scatter-graphs"));var d=l.selectAll(".d2b-scatter-graph").data(function(e,n){return t(e,n)},function(t){return t.key}),c=d.enter().append("g").attr("class","d2b-scatter-graph d2b-graph").style("opacity",0),u=d.merge(c).order(),s=d.exit();return o!==i&&(u=u.transition(o),s=s.transition(o),s.style("opacity",0).each(function(t){var a=e.select(this),l=r.x,d=r.y,c=a.selectAll(".d2b-scatter-point");o!==i&&(c=c.transition(o));var u=t.shift;null===u&&(u=l.bandwidth?l.bandwidth()/2:0),c.style("opacity",0).call(n,l,d,u,t.align).remove()})),u.style("opacity",1),s.remove(),u.each(function(t){var a=e.select(this),l=r.x,d=r.y,c=this.parentNode,u=c.__scaleX||l,s=c.__scaleY||d,p=t.shift;null===p&&(p=l.bandwidth?l.bandwidth()/2:0);var b=p;null===b&&(p=u.bandwidth?u.bandwidth()/2:0),t.tooltipGraph&&t.tooltipGraph.data(t.values).x(function(t){return l(t.x)+p}).y(function(t){return d(t.y)}).color(function(e){return e.color||t.color}),r.point.fill(function(e){return e.color||t.color}).type(function(e){return e.symbol||t.symbol}).size(function(t){return t.size});var h=a.selectAll(".d2b-scatter-point").data(t.values,function(t){return t.key}),f=h.enter().append("g").attr("class","d2b-scatter-point"),g=h.merge(f).order(),y=h.exit();o!==i&&(g=g.transition(o),y=y.transition(o)),u.bandwidth||s.bandwidth||l.bandwidth||d.bandwidth?f.call(n,l,d,p,t.align):f.call(n,u,s,b,t.align),f.style("opacity",0),g.style("opacity",1).call(r.point).call(n,l,d,p,t.align),y.style("opacity",0).call(n,l,d,p,t.align).remove()}),l.each(function(){this.__scaleX=r.x.copy(),this.__scaleY=r.y.copy()}),i.dispatch("svg-scatter-updated",{bubbles:!0}),a},o=f().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),i=e.nest().key(function(t){var e=t.stackBy;return e!==!1&&null!==e?e:j()});return p(a,r).addProp("point",M().active(!0)).addProp("stack",o.stack(),null,function(t){return o.stack(t)}).addProp("x",e.scaleLinear()).addProp("y",e.scaleLinear()).addPropGet("type","scatter").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("symbol",function(){return e.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pkey",function(t,e){return e}).addPropFunctor("psize",25).addMethod("getComputedGraphs",function(e){return(e.selection?e.selection():e).data().map(function(e,n){return t(e,n)})}).addMethod("getVisiblePoints",function(t){var e=a.getComputedGraphs(t);return e.map(function(t){return[].concat.apply([],t.map(function(t){return t.values.map(function(e){return{x:e.x,y:e[t.align],graph:t}})}))})[0]}),a}function B(){function t(t){return"horizontal"===t?{rotate:!0,px:"py",py:"px",x:"y",y:"x",w:"height",h:"width"}:{rotate:!1,px:"px",py:"py",x:"x",y:"y",w:"width",h:"height"}}function n(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t(s.orient(e,n)),o=s.graphs(e,n).map(function(t,e){var n={data:t,index:e,tooltipGraph:s.tooltipGraph(t,e),shift:s.shift(t,e),stackBy:s.stackBy(t,e),key:s.key(t,e),color:s.color(t,e)};return n.values=s.values(t,e).map(function(t,e){return{data:t,index:e,graph:n,key:s.pkey(t,e),x:s.px(t,e),y:s.py(t,e),centered:s.pcentered(t,e),color:s.pcolor(t,e)}}),n});return h.x(function(t){return t[a.x]}).y(function(t){return t[a.y]}),g.entries(o).forEach(function(t,e){return h.out(r(e))(t.values)}),u(o,s.baseline(e,n)),o}function r(t){var e={};return function(n,r,a,o){var i=e[o]=e[o]||[0,0];n.dy=a-r,n.stackIndex=t,n.base=o,n.dy>0?n.extent=[i[0],i[0]+=n.dy]:n.extent=[i[1],i[1]+=n.dy]}}function a(t,e){t.style("opacity",e.opacity).call(i,e,e.orientMap).select("rect").attr("fill",function(t){return t.color||e.graph.color}).attr(e.orientMap.w,e.width).attr(e.orientMap.h,e.height)}function i(t,e,n){t.attr("transform",function(t){var r=e[n.x](t),a=e[n.y](t);return"translate("+[r,a]+")"})}function l(t,e,n,r){return function(a,o){var i=a.centered?o-e/4:o-e/2+a.stackIndex*n+r;return t(a.base)+i}}function d(t){var n=function(e){return[t(e.extent[0]),t(e.extent[1])]};return n.sorted=function(t){return n(t).slice().sort(e.ascending)},n}function c(t,n,r){var a=[],o=1/0;n.forEach(function(e){var n=e.values,i=t.range();o=Math.min(o,Math.abs(i[1]-i[0])),n.forEach(function(e){a.push(t(e[r.x]))})}),a.sort(e.ascending);for(var i=0;i<a.length-1;i++)a[i+1]!==a[i]&&(o=Math.min(a[i+1]-a[i],o));return o===1/0?0:o}function u(t,n){if(null===n){var r=[].concat.apply([],t.map(function(t){return t.values})),a=e.extent(r.map(function(t){return t.extent[1]}));n=a[1]<0?a[1]:a[0]>0?a[0]:0}t.forEach(function(t){t.values.forEach(function(t){Math.abs(t.extent[0])<Math.abs(n)&&(t.extent[0]=n)})})}var s={},b=function r(i){var u=i.selection?i.selection():i,p={x:s.x,y:s.y};return u.each(function(r,b){var h=s.orient(r,b),f=t(h),y=n(r,b,f),v=p[f.x].copy(),m=p[f.y].copy(),x=s.padding(r,b),k=s.groupPadding(r,b),P=s.bandwidth(r,b);P=(1-x)*o(P||c(v,y,f));var w=g.entries(y),F=P/Math.max(1,w.length);k*=F;var _=l(v,P,F,k),A=d(m);F-=2*k;var M=e.select(this).selectAll(".d2b-bar-graphs").data(function(t){return[t]});M=M.merge(M.enter().append("g").attr("class","d2b-bar-graphs"));var z=M.node(),E=z.__scaleBase||_,R=z.__scaleY||m,C=z.__scaleX||v,G=z.__barWidth||F,B=M.selectAll(".d2b-bar-graph").data(y,function(t){return t.key}),T=B.enter().append("g").attr("class","d2b-bar-graph d2b-graph"),O=B.merge(T).order(),X=B.exit();i!==u&&(O=O.transition(i),X=X.transition(i),X.each(function(t){var n=t.shift;null===n&&(n=v.bandwidth?v.bandwidth()/2:0);var r=e.select(this).selectAll(".d2b-bar-group").transition(i);C.bandwidth||R.bandwidth||v.bandwidth||m.bandwidth?r.style("opacity",0):r.call(a,{opacity:0,x:function(t){return _(t,n)},y:function(){return m(0)},width:F,height:0,graph:t,orientMap:f})})),X.remove(),O.each(function(t){var n=e.select(this),r=t.shift;null===r&&(r=v.bandwidth?v.bandwidth()/2:0);var o=n.selectAll(".d2b-bar-group").data(t.values,function(t){return t.key}),l=o.enter().append("g").attr("class","d2b-bar-group");l.append("rect");var d=o.merge(l).order(),c=o.exit();t.tooltipGraph&&t.tooltipGraph.data(t.values)[f.x](function(t){return v(t.base)+r})[f.y](function(t){return A(t)[1]}).color(function(e){return e.color||t.color}),i!==u&&(d=d.transition(i),c=c.transition(i)),l.attr("class","d2b-bar-group"),c.remove(),C.bandwidth||R.bandwidth||v.bandwidth||m.bandwidth?(l.call(a,{opacity:0,x:function(t){return _(t,r)},y:function(){return m(0)},width:G,height:0,graph:t,orientMap:f}),c.style("opacity",0)):(l.call(a,{opacity:0,x:function(t){return E(t,r)},y:function(){return R(0)},width:G,height:0,graph:t,orientMap:f}),c.call(a,{opacity:0,x:function(t){return _(t,r)},y:function(){return m(0)},width:F,height:0,graph:t,orientMap:f})),d.call(a,{opacity:1,x:function(t){return _(t,r)},y:function(t){return A.sorted(t)[0]},width:F,height:function(t){return A.sorted(t)[1]-A.sorted(t)[0]},graph:t,orientMap:f})}),z.__scaleY=m,z.__scaleX=v,z.__scaleBase=_,z.__barWidth=F}),u.dispatch("svg-bar-updated",{bubbles:!0}),r},h=f().values(function(t){return t.values}),g=e.nest().key(function(t){return t.stackBy});return p(b,s).addProp("x",e.scaleLinear()).addProp("y",e.scaleLinear()).addPropGet("type","bar").addPropFunctor("graphs",function(t){return t}).addPropFunctor("padding",.5).addPropFunctor("groupPadding",0).addPropFunctor("bandwidth",null).addPropFunctor("baseline",0).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("orient","vertical").addPropFunctor("shift",null).addPropFunctor("stackBy",function(t,e){return e}).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values},null).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcentered",!1).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,e){return e}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,e){return n(t,e)})}).addMethod("getVisiblePoints",function(e){return(e.selection?e.selection():e).data().map(function(e,r){var a=s.orient(e,r),o=t(a),i=n(e,r,o),l=[].concat.apply([],i.map(function(t){return t.values.map(function(e){var n={};return n[""+o.x]=e.base,n[""+o.y]=e.extent[0],n.graph=t,n})})),d=[].concat.apply([],i.map(function(t){return t.values.map(function(e){var n={};return n[""+o.x]=e.base,n[""+o.y]=e.extent[1],n.graph=t,n})}));return l.concat(d)})[0]}),b}function T(){function t(e,n,r){return{data:e,index:n,graph:r,x:s.px(e,n),y:s.py(e,n),color:s.pcolor(e,n)||r.color,symbol:s.psymbol(e,n)||r.symbol,key:s.pkey(e,n),size:s.psize(e,n),indicator:s.pindicator(e,n),children:(s.pchildren(e,n)||[]).map(function(e,n){return t(e,n,r)})}}function n(e,n){var r=s.graphs(e,n).map(function(e,n){var r={data:e,index:n,tendancy:s.tendancy(e,n),tooltipGraph:s.tooltipGraph(e,n),shift:s.shift(e,n),key:s.key(e,n),color:s.color(e,n),symbol:s.symbol(e,n)};return r.values=s.values(e,n).map(function(e,n){return t(e,n,r)}),r});return r.forEach(function(t){return t.values.forEach(function(e){return u(e,t.tendancy)})}),r}function r(t,e){t.data.expanded=e,t.children.forEach(function(t){return r(t,e)})}function i(t,e){var n=5,r=5;t.selectAll(".d2b-bubble-indicator.d2b-active").attr("transform",function(){var t=this.getBBox();t.width+n>e&&n>0&&(n=5,r+=t.height+5);var a="translate("+n+", "+r+")";return n+=t.width+5,a})}function l(t,n,r,a,o){t.each(function(t){var i=e.select(this),l=i.attr("transform");l||i.attr("transform","translate("+(r(t.parent?t.parent.x:t.x)+o+",")+(a(t.parent?t.parent.y:t.y)+")")),t.children.length&&!t.data.expanded?i.attr("cursor","pointer").on("click",function(){e.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){return t.data.expanded=!t.data.expanded}):i.attr("cursor","").on("click",null),n&&(i=i.transition(n)),t.data.expanded?i.style("opacity",0).selectAll("*").remove():i.style("opacity",null).call(s.point),i.attr("transform","translate("+(r(t.x)+o)+", "+a(t.y)+")")})}function d(t){t.each(function(t){var n=e.select(this).classed("d2b-active",t.data.expanded);if(!t.data.expanded)return n.selectAll("rect, text, path").remove();var a=n.select("rect"),o=n.select("text"),i=n.select("path");a.size()||(a=n.append("rect")),o.size()||(o=n.append("text")),i.size()||(i=n.append("path")),o.text(function(t){return t.indicator.substring(0,5)}).attr("x",20);var l=o.node().getBBox();o.attr("y",l.height/1.35),a.on("click",function(){e.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){t.data.expanded=!t.data.expanded,t.data.expanded||r(t,!1)}).attr("width",l.width+25).attr("height",l.height).style("fill",s.point.fill()).style("stroke",s.point.stroke()),i.attr("d",function(t){return b.type(t.symbol)()}).attr("transform","translate(10, 9.5)").style("fill",s.point.stroke())})}function c(t,n,r,a,o,i,u,s,p,b,h){var f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,g=t.selectAll(".d2b-bubble-pack.d2b-depth-"+f).data(n,function(t){return t.key}),y=g.enter().append("g").attr("class","d2b-bubble-pack d2b-depth-"+f),v=g.merge(y),m=y.append("g").attr("class","d2b-bubble-point");h&&l(m,!1,i,u,s),m.style("opacity",0),l(v.select(".d2b-bubble-point"),r,a,o,s),y.append("g").attr("class","d2b-bubble-indicator"),d(v.select(".d2b-bubble-indicator")),v.each(function(t){var n=e.select(this),l=n.selectAll(".d2b-bubble-pack");l=r?l.transition(r):l,t.children.length&&t.data.expanded?c(n,t.children,r,a,o,i,u,s,p,b,h,f+1):(b&&b(t),l.remove().select(".d2b-bubble-point").style("opacity",0).attr("transform","translate("+[a(t.x)+s,o(t.y)]+")"))});var x=g.exit();r&&(x=x.transition(r)),x.remove()}function u(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.children=t.children||[],t.leaves=t.children.length?[]:[t],t.depth=r,t.children.length&&t.children.forEach(function(e){u(e,n,r+1),e.parent=t,t.leaves=t.leaves.concat(e.leaves)}),t.size=o(t.size,e.sum(t.leaves,function(t){return t.size})),t.x=o(t.x,(n.x||n)(t.leaves,function(t){return t.x},function(t){return t.size})),t.y=o(t.y,(n.y||n)(t.leaves,function(t){return t.y},function(t){return t.size}))}var s={},b=e.symbol().size(80),h=function t(r){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.selection?r:null,l=r.selection?r.selection():r,d=l.selectAll(".d2b-bubble-pack-graphs").data(function(t){return[t]});d=d.merge(d.enter().append("g").attr("class","d2b-bubble-pack-graphs"));var u=d.selectAll(".d2b-bubble-pack-graph").data(function(t,e){return n(t,e)},function(t){return t.key}),p=u.enter().append("g").attr("class","d2b-bubble-pack-graph d2b-graph"),b=u.merge(p).order(),h=u.exit();return o&&(b=b.transition(o),h=h.transition(o)),b.style("opacity",1),h.style("opacity",0).remove(),r.each(function(n,r){var l=e.select(this),d=s.duration(n,r),u=l.selectAll(".d2b-bubble-pack-graph"),p=l.selectAll(".d2b-bubble-pack-graphs").node(),b=p.__d2bPreserveScaleX__||s.x,h=p.__d2bPreserveScaleY__||s.y;l.on("change",function(){l.transition().duration(d).call(t,!1)});var f=0;u.each(function(t){var n=e.select(this),r=s.x.range();f=Math.max(f,Math.abs(r[0]-r[1]));var i=t.shift;null===i&&(i=s.x.bandwidth?s.x.bandwidth()/2:0),s.point.active(function(t){return!!t.children.length}).fill(function(t){return t.color}).type(function(t){return t.symbol});var d=t.tooltipGraph?t.tooltipGraph.clear().x(function(t){return s.x(t.x)+i}).y(function(t){return s.y(t.y)}).color(function(t){return t.color}).addPoint:null;c(n,t.values,o,s.x,s.y,b,h,i,l,d,a)}),i(l,f)}),d.each(function(){this.__d2bPreserveScaleX__=s.x.copy(),this.__d2bPreserveScaleY__=s.y.copy()}),l.dispatch("svg-bubble-pack-updated",{bubbles:!0}),t};return p(h,s).addProp("point",M().size(function(t){return 100*t.size})).addProp("x",e.scaleLinear()).addProp("y",e.scaleLinear()).addPropGet("type","bubblePack").addPropFunctor("duration",250).addPropFunctor("graphs",function(t){return t}).addPropFunctor("tendancy",x,function(t){return arguments.length?(t&&t.tendancy?s.tendancy=function(){return t}:s.tendancy=a(t),h):s.tendancy}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("symbol",function(){return e.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("psize",function(t){return t.size}).addPropFunctor("pchildren",function(t){return t.children}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pindicator",function(t){return t.label}).addPropFunctor("pkey",function(t,e){return e}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,e){return n(t,e)})}).addMethod("getVisiblePoints",function(t){function e(t,n,r){t.data.expanded?t.children.forEach(function(t){return e(t,n,r)}):n.push({x:t.x,y:t.y,graph:r})}var n=h.getComputedGraphs(t);return n.map(function(t){return[].concat.apply([],t.map(function(t){var n=[];return t.values.forEach(function(r){return e(r,n,t)}),n}))})[0]}),h}function O(){function t(t){return n(e.hierarchy(t,y.children).sum(y.size))}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.key=y.key(t.data,e),t.color=y.color(t.data,e),t.label=y.label(t.data,e),t.children)return t.children.forEach(n),t}function r(t){var e=null;return t.each(function(t){t.data.selected&&(e=t)}),e||(e=t),e.data.selected=!0,e}function a(t,e){t.ancestors().concat(t.descendants()).filter(function(t){return t.depth<=e&&t.value>0}).forEach(function(t){return t.visible=!0})}function i(t,e,n,r){var a=y.innerRadius(t,e),o=y.outerRadius(t,e),i=y.ancestorPadding(t,e),l=y.ancestorRatio(t,e),d=0;n.each(function(t){t.visible&&(d=Math.max(d,t.depth))});var c=o-a-i,u=a+c*l,s=y.ancestorBanding.copy().range([a,u]).domain([0,r.depth+1]),p=y.descendantBanding.copy().range([u+i,o]).domain([r.depth+1,d+1]);return function(t){var e=void 0;return e=t<=r.depth?s:p,{inner:e(t),outer:e(t+1)}}}function l(t){return t>Math.PI?_(t)+90:_(t)-90}function c(t,e){var n=(e.inner-e.outer)/2.2;return t>Math.PI?-n:n}function u(t){return t>Math.PI?"end":"start"}function b(t,n,r,a,o,i){var p="arc"===n?d:s;t=t.filter(function(t){return t.visible}),y.pie.startAngle(a).endAngle(o),y.pie(t).forEach(function(t){var e=i.radii(t.data.depth);t.data.startAngle=t.startAngle,t.data.endAngle=t.endAngle,t.data.padAngle=t.padAngle,t.data.innerRadius=e.inner,t.data.outerRadius=e.outer,t.data.centerAngle=(t.startAngle+t.endAngle)/2,t.data.rotate=l(t.data.centerAngle),t.data.labelOffset=c(t.data.centerAngle,e),t.data.labelAnchor=u(t.data.centerAngle)});var f=e.select(this),g="d2b-sunburst-level-"+r,m=f.selectAll(".d2b-sunburst-"+n+"-group."+g),x=m.data();m=m.data(t,function(t){return t.key});var k=m.enter().append("g").attr("class","d2b-sunburst-"+n+"-group "+g),P=k.append("arc"===n?"path":"text").attr("class","d2b-sunburst-"+n+" "+g).each(function(e,n){var r=i.oldRadii(e.depth),a=e.neighbor||h(n,x,t);this.current={startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:r.inner,outerRadius:r.outer,rotate:l((a.startAngle+a.endAngle)/2)},e.children&&e.children.forEach(function(t){return t.neighbor=a})});k.append("g").attr("class","d2b-sunburst-"+n+"-children "+g),"arc"===n?P.style("fill",function(t){return t.color}):P.style("opacity",0).attr("y",4);var w=m.exit();m=m.merge(k),m.select(".d2b-sunburst-"+n+"."+g).classed("d2b-sunburst-ancestor",function(t){return t.depth<t.selected.depth}),i.transition&&(w.each(function(r,a){var o=h(a,t,x),d=e.select(this),u=d.selectAll(".d2b-sunburst-"+n).datum(function(t){var e=i.radii(t.depth);return t.innerRadius=e.inner,t.outerRadius=e.outer,t.startAngle=o.startAngle,t.endAngle=o.endAngle,t.centerAngle=o.centerAngle,t.rotate=l(t.centerAngle),t.labelOffset=c(t.centerAngle,e),t}).transition(i.transition).call(p,v);"label"===n&&u.style("opacity",0).attr("x",function(t){return t.labelOffset})}),w=w.transition(i.transition),m=m.transition(i.transition)),w.remove();var F=m.select(".d2b-sunburst-"+n+"."+g).call(p,v);"arc"===n?F.style("fill",function(t){return t.color}):F.text(function(t){return t.depth>=t.selected.depth?t.label:""}).style("opacity",1).attr("x",function(t){return t.labelOffset}).style("text-anchor",function(t){return t.labelAnchor}),m.select(".d2b-sunburst-"+n+"-children."+g).each(function(t){var e=t.children||[];b.call(this,e,n,r+1,t.startAngle,t.endAngle,i)})}function h(t,e,n){var r=f(t,e,n),a=g(t,e,n);return r?{startAngle:r.endAngle,endAngle:r.endAngle}:a?{startAngle:a.startAngle,endAngle:a.startAngle}:{startAngle:0,endAngle:0,centerAngle:0}}function f(t,e,n){for(var r=e.length;--t>=0;)for(var a=n[t].key,o=0;o<r;++o)if(e[o].key===a)return e[o]}function g(t,e,n){for(var r=n.length,a=e.length;++t<r;)for(var o=n[t].key,i=0;i<a;++i)if(e[i].key===o)return e[i]}var y={},v=e.arc(),m=function n(l){var d=l.selection?l.selection():l;return y.pie.value(function(t){return t.value}),d.each(function(c,u){var s=e.select(this),p=y.zoomable(c,u),h=y.highlight(c,u),f=y.innerRadius(c,u),g=y.showLabels(c,u),v=t(c),m=r(v);a(m,y.descendantLevels(c,u)+m.depth),v.each(function(t){return t.selected=m});var x=i(c,u,v,m);b.call(this,[v],"arc",0,y.startAngle(c,u),y.endAngle(c,u),{transition:l!==d?l:null,oldRadii:o(this.__radii,x),radii:x,zoomable:p}),b.call(this,g?[v]:[],"label",0,y.startAngle(c,u),y.endAngle(c,u),{transition:l!==d?l:null,oldRadii:o(this.__radii,x),radii:x});var k=s.selectAll(".d2b-sunburst-center");k.data([m]).enter().append("circle").attr("class","d2b-sunburst-center").merge(k).attr("cx",0).attr("cy",0).attr("r",Math.max(0,f)).on("click",function(t){t.parent&&(t.data.selected=!1,t.parent.data.selected=!0,s.transition().duration(y.duration(t,u)).call(n))}),this.__radii=x,s.selectAll("path.d2b-sunburst-arc").on("click",p?function(t){v.each(function(t){return t.data.selected=!1}),t.data.selected=!0,s.transition().duration(y.duration(c,u)).call(n)}:null).on("mouseover",h?function(t){var e=t.ancestors();s.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",function(t){return e.indexOf(t)===-1}),s.selectAll(".d2b-sunburst-label").classed("d2b-transparent",function(t){return e.indexOf(t)===-1})}:null).on("mouseout",function(){s.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",!1),s.selectAll(".d2b-sunburst-label").classed("d2b-transparent",!1)})}),d.dispatch("svg-sunburst-updated",{bubbles:!0}),n};return p(m,y).addProp("pie",e.pie().sort(null)).addProp("ancestorBanding",e.scaleLinear()).addProp("descendantBanding",e.scalePow().exponent(.85)).addPropFunctor("duration",250).addPropFunctor("innerRadius",30).addPropFunctor("outerRadius",200).addPropFunctor("ancestorPadding",10).addPropFunctor("ancestorRatio",.2).addPropFunctor("descendantLevels",1/0).addPropFunctor("startAngle",0).addPropFunctor("endAngle",2*Math.PI).addPropFunctor("showLabels",!1).addPropFunctor("zoomable",!0).addPropFunctor("highlight",!0).addPropFunctor("key",function(t){return y.label(t)}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return W(y.label(t))}).addPropFunctor("children",function(t){return t.children}).addPropFunctor("size",function(t){return t.size}),m}function X(){var t={},r=function r(a){var o=a.selection?a.selection():a;return o.each(function(r){function i(t){return l(t)?y+5:-5}function l(t){return t.x0<b.width/2}function d(t){return 5+Math.max(0,t.y1-t.y0)/2}function c(n){if(n.draggableX&&(n.x0=Math.max(0,Math.min(b.width-y,n.x0+e.event.dx)),n.x1=n.x0+y,this.__dragX0=n.x0/b.width),n.draggableY){var r=n.y1-n.y0;n.y0=Math.max(0,Math.min(b.height-(n.y1-n.y0),n.y0+e.event.dy)),n.y1=n.y0+r,this.__dragY0=n.y0/b.height}t.sankey.update(v),u()}function u(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O.select("text").text(function(t){return t.label}).classed("d2b-text-anchor-end",function(t){return!l(t)});var n=t?A:E,r=t?G:O;n.style("opacity",1).select("path").attr("d",h).style("stroke",function(t){return"url(#"+t.keyTrim+")"}).style("stroke-width",function(t){return t.width+"px"}),n.each(function(n){var r=e.select(this);if(Math.abs(n.y1-n.y0)<1e-5){var a=r.selectAll("rect").data([n]),o=a.enter().append("rect"),i=n.target.x0-n.source.x1;a=a.merge(o),t&&(a=a.transition(t)),a.attr("x",n.source.x1+Math.min(0,i)).attr("y",n.y0-n.width/2).attr("height",Math.max(0,n.width)).attr("width",Math.abs(n.target.x0-n.source.x1)).style("fill","url(#"+n.keyTrim+")"),r.select("path").style("display","none")}else r.select("rect").remove(),r.select("path").style("display","")}),r.attr("transform",function(t){return"translate("+t.x0+", "+t.y0+")"}).style("opacity",1),r.select("rect").attr("width",Math.max(0,y)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}).style("fill",function(t){return t.color}),r.select("text").attr("x",i).attr("y",d)}var s=a===o?null:a,p=e.select(this),b=t.size(r),h=n.sankeyLinkHorizontal(),f=t.nodes(r).map(function(e,n){var r=t.nodeKey(e);return{key:r,label:t.nodeLabel(e,r),color:t.nodeColor(e,r),draggableX:t.nodeDraggableX(e),draggableY:t.nodeDraggableY(e),preserveDragging:t.nodePreserveDragging(e),data:e,index:n}}),g=t.links(r).map(function(e,n){var r=t.linkSource(e,n),a=t.linkTarget(e,n),o="object"===("undefined"==typeof r?"undefined":Q(r))?t.nodeKey(r):r,i="object"===("undefined"==typeof a?"undefined":Q(a))?t.nodeKey(a):a,l=t.linkKey(e,n,o,i);return{sourceKey:o,targetKey:i,key:l,keyTrim:l.replace(/ /g,""),sourceColor:t.linkSourceColor(e,n,o),targetColor:t.linkTargetColor(e,n,i),value:t.linkValue(e,n),source:r,target:a,data:e,index:n}});t.sankey.size([b.width,b.height]).nodeId(function(t){return t.key}).nodes(f).links(g);var y=t.sankey.nodeWidth(),v=t.sankey.nodes(f).links(g)();v.links=v.links.filter(function(t){return!!t.value}),v.nodes=v.nodes.filter(function(t){return!!t.value}),v=t.sankey.nodes(v.nodes).links(v.links)();var m=p.selectAll(".d2b-sankey-link-defs").data([v.links]),x=m.enter().append("defs").attr("class","d2b-sankey-link-defs");m=m.merge(x);var k=m.selectAll(".d2b-def-gradient").data(function(t){return t},function(t){return t.keyTrim}),P=k.enter().append("linearGradient").attr("class","d2b-def-gradient"),w=k.exit();P.append("stop").attr("class","d2b-gradient-from").attr("offset","0%"),P.append("stop").attr("class","d2b-gradient-to").attr("offset","100%"),k=k.merge(P),s&&(w=w.transition(s),k=k.transition(s)),w.remove(),k.attr("id",function(t){return t.keyTrim}),k.select(".d2b-gradient-from").attr("stop-color",function(t){return t.sourceColor}),k.select(".d2b-gradient-to").attr("stop-color",function(t){return t.targetColor});var F=p.selectAll(".d2b-sankey-links").data([v.links]),_=F.enter().append("g").attr("class","d2b-sankey-links");F=F.merge(_);var A=F.selectAll(".d2b-sankey-link").data(function(t){return t},function(t){return t.key}),M=A.enter().append("g").attr("class","d2b-sankey-link"),z=A.exit(),E=A=A.merge(M);s&&(A=A.transition(s),z=z.transition(s));var R=p.selectAll(".d2b-sankey-nodes").data([v.nodes]),C=R.enter().append("g").attr("class","d2b-sankey-nodes");R=R.merge(C);var G=R.selectAll(".d2b-sankey-node").data(function(t){return t},function(t){return t.key}),B=G.enter().append("g").attr("class","d2b-sankey-node"),T=G.exit(),O=G=G.merge(B);s&&(G=G.transition(s),T=T.transition(s)),G.each(function(t){if(t.draggableX||t.draggableY?e.select(this).classed("d2b-draggable",!0).call(e.drag().on("drag",c)):e.select(this).classed("d2b-draggable",!1).on(".drag",null),t.preserveDragging&&(void 0!==this.__dragX0&&(t.x0=this.__dragX0*b.width,t.x1=t.x0+y),void 0!==this.__dragY0)){var n=t.y1-t.y0;t.y0=this.__dragY0*b.height,t.y1=t.y0+n}}),t.sankey.update(v),M.style("opacity",0).append("path").attr("d",h).style("stroke",function(t){return"url(#"+t.keyTrim+")"}).style("stroke-width",function(t){return t.width+"px"}),z.style("opacity",0).remove(),B.attr("transform",function(t){return"translate("+t.x0+", "+t.y0+")"}).style("opacity",0),B.append("rect").attr("width",Math.max(0,y)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}),B.append("text").attr("x",i).attr("y",d),T.style("opacity",0).remove(),u(s)}),o.dispatch("svg-sankey-updated",{bubbles:!0}),r};return p(r,t).addProp("sankey",n.sankey()).addPropFunctor("size",{width:960,height:500}).addPropFunctor("nodes",function(t){return t.nodes}).addPropFunctor("nodeKey",function(t){return t.name}).addPropFunctor("nodeLabel",function(t,e){return e}).addPropFunctor("nodeDraggableX",!1).addPropFunctor("nodeDraggableY",!1).addPropFunctor("nodePreserveDragging",!0).addPropFunctor("nodeColor",function(t,e){return W(e)}).addPropFunctor("links",function(t){return t.links}).addPropFunctor("linkSource",function(t){return t.source}).addPropFunctor("linkSourceColor",function(t,e,n){return W(n)}).addPropFunctor("linkTarget",function(t){return t.target}).addPropFunctor("linkTargetColor",function(t,e,n){return W(n)}).addPropFunctor("linkKey",function(t,e,n,r){return n+"-"+r}).addPropFunctor("linkValue",function(t){return t.value}),r}function Y(){function t(t,e,n,r,a){var o=[],i=[],l=t.data;l&&(u(t,l,e,n,r),o=[l],t.info.showGrid&&(i=[l])),t.update=n.selectAll(".d2b-"+t.type+"-axis").data(o),t.enter=t.update.enter().append("g").attr("class","d2b-axis d2b-"+t.type+"-axis"),t.labelEnter=t.enter.append("text").attr("class","d2b-axis-label"),t.svg=t.enter.merge(t.update),t.label=t.svg.select(".d2b-axis-label"),t.update.exit().remove(),t.gridUpdate=n.selectAll(".d2b-"+t.type+"-grid").data(i),t.gridEnter=t.gridUpdate.enter().append("g").attr("class","d2b-grid d2b-"+t.type+"-grid"),t.gridUpdate.exit().remove(),t.grid=t.gridEnter.merge(t.gridUpdate),a&&(t.svg=t.svg.transition(a),t.update=t.update.transition(a),t.grid=t.grid.transition(a),t.gridUpdate=t.gridUpdate.transition(a),t.label=t.label.transition(a))}function n(t,e,n,r){t.data&&(d(t),c(t,e),t.enter.call(t.info.axis).attr("transform","translate("+n+", "+r+")"),t.update.call(t.info.axis).attr("transform","translate("+n+", "+r+")"),t.svg.call(y,t).on("end",function(){t.svg.call(y,t)}))}function r(t,e,n){t.data&&(l(t,n),c(t,e),t.gridUpdate.call(t.info.axis).selectAll(".tick text").remove(),t.gridEnter.call(t.info.axis).selectAll(".tick text").remove())}function a(t,e){t.data&&(t.labelEnter.text(t.info.label).attr("x",f(t,e)).attr("y",h(t)).attr("text-anchor",s(t)),t.label.text(t.info.label).attr("x",f(t,e)).attr("y",h(t)).attr("text-anchor",s(t)))}function l(t,e){if(t.data)switch(t.type){case"x":return t.info.axis.tickSize("inner"===t.info.orient?-e:e);case"x2":return t.info.axis.tickSize("inner"===t.info.orient?e:-e);case"y":return t.info.axis.tickSize("inner"===t.info.orient?e:-e);case"y2":return t.info.axis.tickSize("inner"===t.info.orient?-e:e)}}function d(t){t.data&&t.info.axis.tickSizeOuter(0).tickSizeInner(t.info.tickSize)}function c(t,e){t.data&&(["y","y2"].indexOf(t.type)>-1?t.info.axis.scale().range([e,0]):t.info.axis.scale().range([0,e]))}function u(t,e,n,r,a){if(t.data){var i=t.info={};i.axis=x.axis(e,n),i.orient=x.orient(e,n),i.wrapLength=x.wrapLength(e,n),i.label=o(x.label(e,n),""),i.labelOrient=x.labelOrient(e,n),i.tickSize=x.tickSize(e,n),i.showGrid=x.showGrid(e,n),i.labelOrient1=i.labelOrient.split(" ")[0],i.labelOrient2=i.labelOrient.split(" ")[1],i.wrapAnchor=b(t),d(t),c(t,a);var l=r.append("g").attr("class","d2b-axis d2b-"+t.type+"-axis").call(i.axis).call(y,t);i.axisBox=l.node().getBBox();var u=l.append("text").attr("class","d2b-axis-label d2b-"+t.type+"-label").text(i.label);i.labelBox=u.node().getBBox(),l.remove()}}function s(t){if(t.data){var e=t.info,n=["y","y2"].indexOf(t.type)>-1;return"start"===e.labelOrient2&&n?"end":"end"!==e.labelOrient2||n?"middle"===e.labelOrient2?"middle":"start":"end"}}function b(t){if(t.data)switch(t.type){case"x":return"inner"===t.info.orient?"end":"start";case"x2":return"outer"===t.info.orient?"end":"start";case"y":case"y2":return"middle";default:return"start"}}function h(t){if(t.data){var e=t.info;switch(t.type+" "+e.orient+" "+e.labelOrient1){case"x inner inner":case"x2 outer outer":return-e.axisBox.height-k;case"x inner outer":case"x2 outer inner":return e.labelBox.height+k;case"x outer inner":case"x2 inner outer":case"y inner outer":case"y2 outer inner":return-k;case"x outer outer":case"x2 inner inner":return e.labelBox.height+e.axisBox.height+k;case"y inner inner":case"y2 outer outer":return e.labelBox.height+e.axisBox.width+k;case"y outer inner":case"y2 inner outer":return e.labelBox.height+k;case"y outer outer":case"y2 inner inner":return-e.axisBox.width-k}}}function f(t,e){if(t.data)return"start"===t.info.labelOrient2?0:"middle"===t.info.labelOrient2?e/2:e}function g(t){var e={top:0,left:0,right:0,bottom:0};return t.x.data&&("outer"===t.x.info.orient&&(e.bottom+=t.x.info.axisBox.height),"outer"===t.x.info.labelOrient1&&(e.bottom+=t.x.info.labelBox.height+k)),t.x2.data&&("outer"===t.x2.info.orient&&(e.top+=t.x2.info.axisBox.height),"outer"===t.x2.info.labelOrient1&&(e.top+=t.x2.info.labelBox.height)),t.y.data&&("outer"===t.y.info.orient&&(e.left+=t.y.info.axisBox.width),"outer"===t.y.info.labelOrient1&&(e.left+=t.y.info.labelBox.height)),t.y2.data&&("outer"===t.y2.info.orient&&(e.right+=t.y2.info.axisBox.width),"outer"===t.y2.info.labelOrient1&&(e.right+=t.y2.info.labelBox.height+k)),e.top=Math.max(e.top,10),e.bottom=Math.max(e.bottom,10),e.left=Math.max(e.left,10),e.right=Math.max(e.right,10),e}function y(t,n){if(n.data){
var r=n.info.wrapLength,a=n.info.wrapAnchor;t.selectAll(".tick text").each(function(){var t=e.select(this);o(t.html(),"").indexOf("tspan")===-1&&(this.storeText=t.text()),t.text("")}).call(i,function(){return this.storeText},r,a)}}function v(t){return"number"==typeof t?{top:t,left:t,right:t,bottom:t}:t}function m(t){return v(t||0)}var x={},k=5,P=function o(i){var l=i.selection?i.selection():i;return l.each(function(o,d){var c=x.size.call(this,o,d)||{width:960,height:500},u=m(x.margin.call(this,o,d)),s=x.x.call(this,o,d),p=x.x2.call(this,o,d),b=x.y.call(this,o,d),h=x.y2.call(this,o,d),f=e.select(this),y={x:{type:"x",data:s},x2:{type:"x2",data:p},y:{type:"y",data:b},y2:{type:"y2",data:h}},k=v(x.padding.call(this,o,d)),P=f.selectAll(".d2b-plane").data([o]),w=P.enter().append("g").attr("class","d2b-plane"),F=P.merge(w),_=this.__clipID=this.__clipID||"d2b-clip-plane-"+j();w.append("defs").append("clipPath").attr("id",_).attr("class","d2b-clip-plane").append("rect");var A=i!==l?i:null;t(y.x,d,F,c.width,A),t(y.x2,d,F,c.width,A),t(y.y,d,F,c.height,A),t(y.y2,d,F,c.height,A),k||(k=g(y));var M={top:k.top+u.top,bottom:k.bottom+u.bottom,left:k.left+u.left,right:k.right+u.right};M.width=c.width-M.left-M.right,M.height=c.height-M.top-M.bottom,this.__box__=M,A&&(P=P.transition(A)),w.attr("transform","translate("+M.left+", "+M.top+")"),P.attr("transform","translate("+M.left+", "+M.top+")"),n(y.x,M.width,0,M.height),n(y.x2,M.width,0,0),n(y.y,M.height,0,0),n(y.y2,M.height,M.width,0),r(y.x,M.width,M.height),r(y.x2,M.width,M.height),r(y.y,M.height,M.width),r(y.y2,M.height,M.width),a(y.x,M.width),a(y.x2,M.width),a(y.y,-M.height),a(y.y2,-M.height),F.select(".d2b-clip-plane").select("rect").attr("width",M.width+1).attr("height",M.height+1),F.selectAll(".d2b-grid").attr("clip-path","url(#"+_+")")}),l.dispatch("plane-updated",{bubbles:!0}),o};return p(P,x).addPropFunctor("size",function(t){return t.size}).addPropFunctor("padding",null).addPropFunctor("margin",0).addPropFunctor("x",function(t){return t.x}).addPropFunctor("x2",function(t){return t.x2}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("y2",function(t){return t.y2}).addPropFunctor("axis",function(t){return t.axis}).addPropFunctor("orient",function(t){return t.orient||"outer"}).addPropFunctor("wrapLength",function(t){return o(t.wrapLength,1/0)}).addPropFunctor("tickSize",function(t){return o(t.tickSize,6)}).addPropFunctor("showGrid",function(t){return t.showGrid!==!1}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("labelOrient",function(t){return t.labelOrient||"outer middle"}).addMethod("box",function(t){var e=t.node?t.node():t;return e?e.__box__:null}),P}function S(){function t(t,d){var c=e.select(this),p=c.select(".d2b-chart-container"),b=p.node().__size__,h=o.radius(t,b.width,b.height),f=o.donutRatio(t),g=o.legend.empty(),y=o.values(t),v=y.filter(function(t){return!g(t)});o.pie.values(v),o.legend.values(y),c.select(".d2b-legend-container").call(o.legend).on("change",function(){return c.transition(o.duration(t)).call(i)}).selectAll(".d2b-legend-item").on("mouseover",function(t){r.call(this,c,t)}).on("mouseout",function(t){a.call(this,c,t)});var m=e.sum(v,function(t){return o.value(t)}),x=p.selectAll(".d2b-pie-chart").data([v]),k=x.enter().append("g").attr("class","d2b-pie-chart");x=x.merge(k),d&&(x=x.transition(d)),o.pie.arc().innerRadius(h*f).outerRadius(h),x.call(o.pie);var P=p.selectAll(".d2b-pie-arc").each(function(t){t.__innerRadius__=h*f,t.__outerRadius__=h,t.__percent__=t.value/m}).on("mouseover",function(t){r.call(this,c,t.data)}).on("mouseout",function(t){a.call(this,c,t.data)}).call(o.tooltip),w=P.selectAll(".d2b-pie-arc-percent").data(function(t){return[t]});w.enter().append("g").attr("class","d2b-pie-arc-percent").append("text").attr("y",6),P.each(function(){var t=e.select(this),n=t.select(".d2b-pie-arc path").node().current,r=t.select(".d2b-pie-arc-percent"),a=r.select("text").node();r.node().current=n,a.current=a.current||0}),d&&(P=P.each(function(){this.transitioning=!0}).transition(d).on("end",function(){this.transitioning=!1})),P.select(".d2b-pie-arc-percent").call(s,o.pie.arc()).select("text").call(u,function(t){return o.value(t.data)/m},l).style("opacity",function(t){return o.showPercent.call(this,t.data,m)?1:0});var F=n(t,h,b);k.attr("transform","translate("+F.x+", "+F.y+")"),x.attr("transform","translate("+F.x+", "+F.y+")")}function n(t,e,n){var r=o.at(t,n.width,n.height,e);if("object"!==("undefined"==typeof r?"undefined":Q(r))){r=r.split(" ");var a={x:r[1],y:r[0]};switch(r={},a.x){case"left":r.x=e;break;case"center":case"middle":r.x=n.width/2;break;case"right":default:r.x=n.width-e}switch(a.y){case"bottom":r.y=n.height-e;break;case"center":case"middle":r.y=n.height/2;break;case"top":default:r.y=e}}return r}function r(t,e){var n=o.pie.arc();n.outerRadius(function(t){return t.outerRadius}).innerRadius(function(t){return t.innerRadius}),t.selectAll(".d2b-pie-arc").filter(function(t){return t.data===e}).each(function(t){t.outerRadius=1.03*t.__outerRadius__,t.innerRadius=t.__innerRadius__}).select("path").transition().duration(100).call(d,n)}function a(t,e){var n=o.pie.arc();n.outerRadius(function(t){return t.outerRadius}).innerRadius(function(t){return t.innerRadius}),t.selectAll(".d2b-pie-arc").filter(function(t){return t.data===e}).each(function(t){t.outerRadius=t.__outerRadius__,t.innerRadius=t.__innerRadius__}).select("path").transition().duration(100).call(d,n)}var o={},i=function n(r){r.call(o.chartFrame),o.pie.value(o.value).color(o.color).key(o.key),o.legend.html(o.label).key(o.key).color(o.color),o.tooltip.color(function(t){return e.rgb(o.color(t.data)).darker(.3)});var a=r.selection?r.selection():r;return a.each(function(e){t.call(this,e,r!==a?r:null)}),a.dispatch("chart-pie-updated",{bubbles:!0}),n},l=e.format(".0%");return p(i,o).addProp("chartFrame",v().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",y().clickable(!0).dblclickable(!0)).addProp("key",function(t){return t.label}).addProp("pie",z()).addProp("tooltip",b().followMouse(!0).html(function(t){return"<b>"+o.label(t.data)+"</b>: "+o.value(t.data)+" ("+l(t.__percent__)+")"})).addPropFunctor("values",function(t){return t}).addPropFunctor("duration",250).addPropFunctor("donutRatio",0).addPropFunctor("at","center center").addPropFunctor("showPercent",function(t,e){return o.value(t)/e>.03}).addPropFunctor("radius",function(t,e,n){return Math.min(e,n)/2}).addPropFunctor("color",function(t){return W(t.label)}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("label",function(t){return t.label}),i}function L(){function t(t,a){var p=e.select(this),b=p.select(".d2b-chart-container"),y=b.node(),v=p.select(".d2b-legend-container"),m=b.node().__size__,x=r(t),P=i(x),w=f.duration(t),F=n(t,x);l(F);var _=y.tooltip=y.tooltip||h().trackX(!0).trackY(!1).threshold(50);_.title(function(t){return""+o(t[0].x,t[0].x1)}).clear(),f.legend.values(F),v.call(f.legend).on("change",function(){return p.transition().duration(w).call(g)}).selectAll(".d2b-legend-item").on("mouseover",function(t){return d(t,b)}).on("mouseout",function(t){return c(t,b)}),f.plane.size(m);var A=b.selectAll(".d2b-axis-plane").data([t]),M=A,z=A.enter().append("g").attr("class","d2b-axis-plane");A=A.merge(z);var E=b.selectAll(".d2b-axis-wrapper").data([t]),R=E,C=E.enter().append("g").attr("class","d2b-axis-wrapper");C.append("rect").attr("class","d2b-axis-background"),E=E.merge(C);var G=E.selectAll(".d2b-axis-set").data(x),B=G.enter().append("g").attr("class","d2b-axis-set"),T=G.exit();G=G.merge(B).order(),a&&(T=T.transition(a),R=R.transition(a),M=M.transition(a));var O={x:[],x2:[],y:[],y2:[]};G.each(function(t){var n=e.select(this);this.genUpdate=n.selectAll(".d2b-graph-generator").data(t.generators,function(t){return t.key}),this.genEnter=this.genUpdate.enter().append("g").attr("class","d2b-graph-generator").style("opacity",0),this.genExit=this.genUpdate.exit(),this.gen=this.genUpdate.merge(this.genEnter).order(),this.gen.each(function(n,r){var a=e.select(this),o=n.generator.tooltipGraph(function(t){if(r)return null;var e=_.graph(j());return u(t,P).tooltipConfig(e),e}).color(function(t){return u(t,P).color}).graphs(t.graphs.map(function(t){return t.data}).filter(function(t){return!t.hidden})).getVisiblePoints(a);n.generator.duration&&n.generator.duration(w),o.forEach(function(e){O[t.xType].push(e.x),O[t.yType].push(e.y)})})});var X=f.x(t,O.x),Y=f.y(t,O.y),S=f.x2(t,O.x2),L=f.y2(t,O.y2);s(X,O.x,k.x),s(Y,O.y,k.y),s(S,O.x2,k.x2),s(L,O.y2,k.y2),f.plane.axis(function(t){return t.__axis__}).x(X.__axis__?X:null).y(Y.__axis__?Y:null).x2(S.__axis__?S:null).y2(L.__axis__?L:null),z.call(f.plane),M.call(f.plane);var N=f.plane.box(A);G.attr("clip-path","url(#"+A.select(".d2b-clip-plane").attr("id")+")"),G.each(function(t){var n="x2"===t.xType?S.__axis__:X.__axis__,r="y2"===t.yType?L.__axis__:Y.__axis__;a&&(this.genUpdate=this.genUpdate.transition(a),this.genExit=this.genExit.transition(a).style("opacity",0)),this.genExit.remove(),this.gen.each(function(t){var o=e.select(this);a&&(o=o.transition(a)),t.generator.x(n.scale()).y(r.scale()),o.style("opacity",1).call(t.generator)}),e.select(this).on("change",function(){return p.transition().duration(w).call(g)})}),T.style("opacity",0).remove(),C.attr("transform","translate("+N.left+", "+N.top+")").select("rect.d2b-axis-background").attr("height",Math.max(0,N.height)).attr("width",Math.max(0,N.width)),R.attr("transform","translate("+N.left+", "+N.top+")").select("rect.d2b-axis-background").attr("height",Math.max(0,N.height)).attr("width",Math.max(0,N.width)),_.row(function(t){var e=u(t.graph.data,P).label;return e+": "+o(t.y,t.y1)}),f.tooltipConfig(_),_.svgContainer(E).tracker(E).size(N)}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(t),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i(e),a=n.filter(function(t){return!t.group});return a.forEach(function(t){t.groupType="graph",t.groupGraphs=[t]}),(f.groups(t)||[]).map(function(t){var e={groupType:"group",data:t,label:f.groupLabel(t),color:f.groupColor(t)};return e.groupGraphs=n.filter(function(t){return e.label===t.group}),e.groupGraphs.forEach(function(t){t.color=e.color}),e}).concat(a)}function r(t){return f.sets(t).map(function(t){var e={};return{data:t,xType:f.setXType(t)||"x",yType:f.setYType(t)||"y",generators:f.setGenerators(t).map(function(t){var n=t.type();return e[n]=e[n]||0,{data:t,key:n+"-"+(e[n]+=1),generator:t}}),graphs:a(t)}})}function a(t){return f.setGraphs(t).map(function(t){return{data:t,label:f.graphLabel(t)||"",color:f.graphColor(t),group:f.graphGroup(t),tooltipConfig:f.graphTooltipConfig(t)||function(){}}})}function i(t){return[].concat.apply([],t.map(function(t){return t.graphs}))}function l(t){t.forEach(function(t){t.groupGraphs.forEach(function(e){return e.data.hidden=t.data.hidden})})}function d(t,e){var n=e.selectAll(".d2b-graph");t.groupGraphs.some(function(t){return!t.data.hidden})&&n.style("opacity",.2).filter(function(e){return t.data===e.data||(t.groupGraphs.map(function(t){return t.data})||[]).indexOf(e.data)>-1}).style("opacity","")}function c(t,e){e.selectAll(".d2b-graph").style("opacity",1)}function u(t,e){return e.filter(function(e){return e.data===t||e.data===t.data})[0]}function s(t,e,n){e.length||(t.hidden=!0);var r=t.axis||n.axis,a=t.scale?t.scale.copy():b(e,n),o=a.domain();if(!a.bandwidth&&t.linearPadding){var i=o[1]-o[0];o[0]=o[0]+i*t.linearPadding[0],o[1]=o[1]+i*t.linearPadding[1]}a.domain(o),t.__axis__=r.scale(a)}function b(t,n){var r=t.some(function(t){return isNaN(t)}),a=r?e.set(t).values():e.extent(t).map(function(t){return t||0}),o=r?n.band:n.linear;return o.domain(a)}var f={},g=function e(n){n.call(f.chartFrame),f.legend.empty(function(t){return t.data.hidden}).setEmpty(function(t,e,n){return t.data.hidden=n}).html(function(t){return t.label}).key(function(t){return t.label}).color(function(t){return t.color});var r=n.selection?n.selection():n;return r.each(function(e){t.call(this,e,n!==r?n:null)}),r.dispatch("chart-axis-updated",{bubbles:!0}),e};p(g,f).addProp("plane",Y()).addProp("chartFrame",v().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",y().clickable(!0).dblclickable(!0)).addPropFunctor("tooltipConfig",function(t){return t.tooltipConfig}).addPropFunctor("duration",250).addPropFunctor("x",{}).addPropFunctor("y",{}).addPropFunctor("x2",{}).addPropFunctor("y2",{}).addPropFunctor("groups",function(t){return t.groups}).addPropFunctor("sets",function(t){return t.sets}).addPropFunctor("groupLabel",function(t){return t.label}).addPropFunctor("groupColor",function(t){return W(f.groupLabel(t))}).addPropFunctor("setGenerators",function(t){return t.generators}).addPropFunctor("setXType",function(t){return t.xType}).addPropFunctor("setYType",function(t){return t.yType}).addPropFunctor("setGraphs",function(t){return t.graphs}).addPropFunctor("graphLabel",function(t){return t.label}).addPropFunctor("graphGroup",function(t){return t.group}).addPropFunctor("graphColor",function(t){return W(f.graphLabel(t))}).addPropFunctor("graphTooltipConfig",function(t){return t.tooltipConfig});var m=e.scaleBand(),x=e.scaleLinear(),k={x:{band:m.copy(),linear:x.copy(),axis:e.axisBottom()},y:{band:m.copy(),linear:x.copy(),axis:e.axisLeft()},x2:{band:m.copy(),linear:x.copy(),axis:e.axisTop()},y2:{band:m.copy(),linear:x.copy(),axis:e.axisRight()}};return g}function N(){function t(t,e){t.select(".d2b-breadcrumbs-container").datum(e).transition("sunburst-breadcrumbs").duration(100).call(a.breadcrumbs)}function n(e){var r=e.select(".d2b-sunburst-chart"),o=e.selectAll(".d2b-sunburst-arc.d2b-sunburst-level-0").datum(),i=o.selected;t(e,[i]),r.selectAll(".d2b-sunburst-arc").call(a.tooltip.clear).call(a.tooltip).on("mouseover.breadcrumbs",function(n){var r=n.ancestors();r=r.slice(0,r.indexOf(i)+1),t(e,r.reverse())}).on("mouseout.breadcrumbs",function(){return t(e,[i])}),r.on("mouseout",function(){return n(e)}).on("click",function(){return n(e)})}function r(t,r){var o=e.select(this),i=o.select(".d2b-chart-container"),l=i.node().__size__,d="translate("+l.width/2+", "+l.height/2+")",c=i.selectAll(".d2b-sunburst-chart").data(function(t){return[t]}),u=c.enter().append("g").attr("transform",d).attr("class","d2b-sunburst-chart");c=c.merge(u),r&&(c=c.transition(r)),a.sunburst.outerRadius(a.outerRadius(t,l.width,l.height)).innerRadius(a.innerRadius(t,l.width,l.height)),c.attr("transform",d).call(a.sunburst),n(o)}var a={},o=function t(e){e.call(a.chartFrame),a.sunburst.label(a.label).color(a.color),a.breadcrumbs.color(function(t){return a.color(t.data)}).key(function(t,e){return e}),a.tooltip.color(function(t){return a.color(t.data)});var n=e.selection?e.selection():e;return n.each(function(t){r.call(this,t,e!==n?e:null)}),n.dispatch("chart-sunburst-updated",{bubbles:!0}),t};p(o,a).addProp("chartFrame",v().legendEnabled(!1).breadcrumbsEnabled(!0)).addProp("sunburst",O()).addProp("breadcrumbs",g().html(function(t){return"<div class = 'd2b-sunburst-breadcrumb'>"+d(t)+"</div>"})).addProp("tooltip",b().followMouse(!0).html(function(t){return"<div class = 'd2b-sunburst-tooltip'>"+d(t)+"</div>"})).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return W(a.label(t))}).addPropFunctor("outerRadius",function(t,e,n){return Math.min(e,n)/2}).addPropFunctor("innerRadius",function(t,e,n){return Math.min(50,Math.min(e,n)/4)});var i=e.format(",.0f"),l=e.format(".1%"),d=function(t){var e=t.value/t.selected.value,n=e>1?"":"<div class = 'd2b-sunburst-percent'>\n        "+l(t.value/t.selected.value)+"\n      </div>";return"\n      <div class = 'd2b-sunburst-label'>\n        "+a.label(t.data)+"\n      </div>\n      <div class = 'd2b-sunburst-value'>\n        "+i(t.value)+"\n        "+n+"\n      </div>\n    "};return o}function D(){function t(e){e.call(r.chartFrame);var a=e.selection?e.selection():e;return a.each(function(t){n.call(this,t,e!==a?e:null)}),a.dispatch("chart-sankey-updated",{bubbles:!0}),t}function n(n,a){var o=e.select(this),i=o.select(".d2b-chart-container"),l=i.node().__size__,d=i.selectAll(".d2b-sankey-chart").data(function(t){return[t]}),c=d.enter().append("g").attr("class","d2b-sankey-chart");return d=d.merge(c),a&&(d=d.transition(a)),d.call(r.sankey.size(l)),d.selectAll(".d2b-sankey-link").call(r.linkTooltip),d.selectAll(".d2b-sankey-node").call(r.nodeTooltip),t}var r={},a=b().html(function(t){return"\n          <b>"+t.key+"</b>:\n          "+t.value+"\n        "}).color(function(t){return t.color}).followMouse(!0),o=b().html(function(t){return"\n          <b>"+t.source.key+"</b>\n          <i class='fa fa-arrow-right d2b-sankey-link-arrow' aria-hidden='true'></i>\n          <b>"+t.target.key+"</b>:\n          "+t.value+"\n        "}).color("#444").followMouse(!0);return p(t,r).addProp("chartFrame",v().legendEnabled(!1).breadcrumbsEnabled(!1)).addProp("sankey",X()).addProp("nodeTooltip",a).addProp("linkTooltip",o),t}r('.d2b-draggable{cursor:move}.d2b-vue-container{width:100%;height:100%}.d2b-pie-chart .d2b-pie-arc path{stroke-width:1px;stroke:#fff}.d2b-pie-chart .d2b-pie-arc text{fill:#fff;font-weight:700;pointer-events:none;text-anchor:middle}.d2b-axis-wrapper .d2b-axis-background{opacity:0}.d2b-chart-breadcrumbs{width:200px;padding-left:10px}.d2b-sunburst-breadcrumb .d2b-sunburst-label,.d2b-sunburst-tooltip .d2b-sunburst-label{text-align:center}.d2b-sunburst-breadcrumb .d2b-sunburst-value,.d2b-sunburst-tooltip .d2b-sunburst-value{font-size:14pt;margin-top:5px}.d2b-sunburst-breadcrumb .d2b-sunburst-percent{float:right}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-sunburst-percent{margin-left:30px}.d2b-sunburst-tooltip{text-align:center}.d2b-sunburst-tooltip .d2b-sunburst-percent{display:inline}.d2b-sunburst-tooltip .d2b-sunburst-percent:before{content:"("}.d2b-sunburst-tooltip .d2b-sunburst-percent:after{content:")"}.d2b-sankey-link-arrow{font-size:10px;position:relative;top:-2px}.d2b-line-graph .d2b-line{stroke-width:1.5px;fill:none}.d2b-area-graph .d2b-area{stroke:none;fill-opacity:0.3}.d2b-bar-graph .d2b-bar-group rect{opacity:0.8}.d2b-bubble-pack-graph .d2b-bubble-point{opacity:0.75}.d2b-bubble-pack-graph .d2b-bubble-indicator rect{fill-opacity:0.25;stroke-opacity:0.9;cursor:pointer;stroke-width:1px}.d2b-bubble-pack-graph .d2b-bubble-indicator rect:hover{stroke-width:2px}.d2b-bubble-pack-graph .d2b-bubble-indicator path,.d2b-bubble-pack-graph .d2b-bubble-indicator text{pointer-events:none}.d2b-plane text{font-size:10pt}.d2b-plane .d2b-y2-axis .d2b-axis-label,.d2b-plane .d2b-y-axis .d2b-axis-label{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.d2b-plane .d2b-y2-axis .tick line,.d2b-plane .d2b-y-axis .tick line{stroke-width:0.6px}.d2b-plane .d2b-grid .tick line{shape-rendering:crispEdges;stroke-width:0.5px;stroke-opacity:0.15}.d2b-plane .d2b-grid .tick text{display:none}.d2b-plane .d2b-axis-label{fill:#000;font-weight:700}.d2b-plane path.domain{stroke-width:0.4px;stroke-opacity:0.4}.d2b-sunburst-arc{-webkit-transition:opacity 0.2s,stroke-width 0.2s;transition:opacity 0.2s,stroke-width 0.2s;cursor:pointer;opacity:0.9;stroke-width:0.8px;stroke:#fff}.d2b-sunburst-arc.d2b-transparent{fill-opacity:0.2}.d2b-sunburst-label{font-size:8pt;fill-opacity:0.8;pointer-events:none;font-family:arial}.d2b-sunburst-label.d2b-transparent{fill-opacity:0.2}.d2b-sunburst-center{fill-opacity:0;stroke:none;cursor:pointer}.d2b-sunburst-ancestor{opacity:0.4}.d2b-sankey-links path{fill:none}.d2b-sankey-links path,.d2b-sankey-links rect{opacity:0.4}.d2b-sankey-links path:hover,.d2b-sankey-links rect:hover{opacity:0.6}.d2b-sankey-nodes rect{stroke-width:0.3px;stroke:#000;opacity:0.6}.d2b-sankey-nodes rect:hover{opacity:0.8}.d2b-text-anchor-end{text-anchor:end}\n/*.d2b-tooltip-area {\n  pointer-events: none;*/.d2b-tooltip{pointer-events:none;background:#fff;border:1px solid #bbb;border-radius:2px;position:fixed;box-shadow:0px 0px 2px #ccc;margin:0}.d2b-tooltip:before{left:0;top:0;position:absolute;z-index:2;content:""}.d2b-tooltip-content{white-space:nowrap;padding:6px 10px}.d2b-tooltip-top{-webkit-transform:translate(-50%,-100%);transform:translate(-50%,-100%);margin-left:0;margin-top:-15px}.d2b-tooltip-top:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:100%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 0;border-top-color:inherit}.d2b-tooltip-bottom{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);margin-left:0;margin-top:15px}.d2b-tooltip-bottom:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:-6px;width:0;height:0;border-style:solid;border-color:transparent;border-width:0 6px 6px;border-bottom-color:inherit}.d2b-tooltip-right{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);margin-left:15px;margin-top:0}.d2b-tooltip-right:before{-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-6px;top:50%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 6px 0;border-right-color:inherit}.d2b-tooltip-left{-webkit-transform:translate(-100%,-50%);transform:translate(-100%,-50%);margin-left:-15px;margin-top:0}.d2b-tooltip-left:before{-webkit-transform:translateY(-50%);transform:translateY(-50%);left:100%;top:50%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 0 6px 6px;border-left-color:inherit}\n/*}*/\n/*.d2b-tooltip-axis-area {\n  pointer-events: none;\n  font-family: \'Arial\';*/.d2b-tooltip-marker{stroke-width:2px;stroke:#bbb;stroke-dasharray:5,5}.d2b-tooltip-axis{pointer-events:none;font-family:Arial;opacity:0.9;white-space:nowrap;border:1px solid #ddd;background:hsla(0,0%,100%,.8);position:absolute;box-shadow:0px 0px 2px #ccc}.d2b-tooltip-axis .d2b-tooltip-title{text-align:center;background:rgba(150,165,175,.8);padding:5px 10px;font-weight:700;color:#fff}.d2b-tooltip-axis .d2b-tooltip-content{padding:5px 10px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row{padding-left:5px;border-left-width:3px;border-left-style:solid;margin-bottom:5px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row:last-child{margin-bottom:0px}\n/*}*/.d2b-breadcrumbs{color:#555;font-size:9pt;box-sizing:content-box}.d2b-breadcrumbs .d2b-breadcrumb{border:0px solid transparent;border-left-width:8px;border-bottom-width:1px;padding:6px 13px;margin-bottom:10px;text-transform:uppercase;position:relative}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after,.d2b-breadcrumbs .d2b-breadcrumb:last-child .d2b-breadcrumb-icon:after{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-15.5px;width:13px;height:13px;text-align:center;font-family:FontAwesome;color:#fff;background-color:inherit;padding:5px;border-radius:15px}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after{content:"\\f015"}.d2b-breadcrumbs .d2b-breadcrumb:not(:first-child):last-child .d2b-breadcrumb-icon:after{content:"\\f25a"}.d2b-breadcrumbs:not(.d2b-vertical){white-space:nowrap}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb{border-right-width:1px;border-top-width:1px;white-space:nowrap;display:inline-block}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child){margin-right:20px}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child):after{width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 0 6px 6px;border-left-color:inherit;position:absolute;z-index:2;content:"";top:50%;left:100%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.d2b-breadcrumbs.d2b-vertical .d2b-breadcrumb{/*&:after {\n      triangle: pointing-right;\n      width: 100px;\n      height: 100px;\n      background-color: inherit;\n      position: absolute;\n      z-index: 2;\n      content: \'\';\n\n      top: 100%;\n      left: 50%;\n\n      transform: translateX(-50%);\n\n    }*/}.d2b-breadcrumbs.d2b-vertical .d2b-breadcrumb:not(:last-child):after{width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 0;border-top-color:inherit;position:absolute;z-index:2;content:"";top:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.stuff{display:none}.d2b-legend{color:#555;font-size:9pt}.d2b-legend .d2b-legend-item{border:0px solid transparent;padding:2px;padding-left:18px;position:relative;cursor:pointer}.d2b-legend .d2b-legend-item .d2b-legend-icon{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:7px;width:12px;height:12px}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon{margin-left:-5px;margin-top:-5px;pointer-events:none}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon path,.d2b-legend .d2b-legend-item .d2b-legend-svg-icon text{font-family:FontAwesome;text-anchor:middle;stroke-width:1px;fill-opacity:0.8}.d2b-legend:not(.d2b-vertical) .d2b-legend-item{display:inline-block}.d2b-legend:not(.d2b-vertical) .d2b-legend-item:not(:last-child){margin-right:10px}.d2b-legend:not(.d2b-vertical) .d2b-legend-icon{margin-top:1.5px}.d2b-chart-frame{height:100%;width:100%;position:relative}.d2b-chart-frame .d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-chart,.d2b-chart-frame .d2b-legend-frame{position:absolute;overflow:auto}.d2b-chart-frame .d2b-breadcrumbs-frame .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame .d2b-breadcrumbs{padding-left:10px;padding-right:2px}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical),.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical){overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend-item,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend-item{white-space:nowrap;overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-legend-frame{height:20px;text-align:center}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-breadcrumbs-frame{height:55px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container{display:table;height:100%;width:100%}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-legend{display:table-cell;vertical-align:middle}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs{display:table-cell;vertical-align:top}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-breadcrumbs-frame{width:180px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-legend-frame{width:110px}',void 0);var I="0.0.35",U=function(){return"ontouchstart"in window||window.navigator.msPointerEnabled},W=e.scaleOrdinal(e.schemeCategory10),j=function(){return Math.random().toString(36).substr(2,9)},V=function(t){return null===t?NaN:+t};x.tendancy="mean",k.tendancy="median",P.tendancy="mode",w.tendancy="range",F.tendancy="midpoint";var K=Math.PI,q=Math.sqrt(8),$=Math.sqrt(2),H={draw:function(t,e){var n=Math.sqrt(e/(K+5/4)),r=.3125*n,a=2*Math.asin(.25),o=(K/2-a)/2,i=n/q-n*Math.cos(o),l=n*Math.sin(o);t.arc(i,l,n,-o,2*K-a-o),t.lineTo(n*(5/4-1/$),-n*(1/q+5/4-1/$)),t.lineTo(n*(5/4-1/$)-r,-n*(1/q+5/4-1/$)),t.lineTo(n*(5/4-1/$)-r,-n*(1/q+7/4-1/$)),t.lineTo(n*(7/4-1/$+1/q),-n*(1/q+7/4-1/$)),t.lineTo(n*(7/4-1/$+1/q),-n*(5/4-1/$)+r),t.lineTo(n*(5/4-1/$+1/q),-n*(5/4-1/$)+r),t.lineTo(n*(5/4-1/$+1/q),-n*(5/4-1/$)),t.closePath()}},J={draw:function(t,e){var n=Math.sqrt(e/(K+5/4)),r=2*Math.asin(.25),a=n/4-n*Math.cos(r/2);t.arc(0,a,n,3*-K/2+r/2,K/2-r/2),t.lineTo(n/4,3*n/4),t.lineTo(3*n/4,3*n/4),t.lineTo(3*n/4,5*n/4),t.lineTo(n/4,5*n/4),t.lineTo(n/4,7*n/4),t.lineTo(-n/4,7*n/4),t.lineTo(-n/4,5*n/4),t.lineTo(3*-n/4,5*n/4),t.lineTo(3*-n/4,3*n/4),t.lineTo(-n/4,3*n/4),t.closePath()}},Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,a){var l={key:t,arg:e,resolve:n,reject:a,next:null};i?i=i.next=l:(o=i=l,r(t,e))})}function r(n,o){try{var i=e[n](o),l=i.value;l instanceof t?Promise.resolve(l.value).then(function(t){r("next",t)},function(t){r("throw",t)}):a(i.done?"return":"normal",i.value)}catch(t){a("throw",t)}}function a(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}o=o.next,o?r(o.key,o.arg):i=null}var o,i;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),{template:'\n    <div :class = \'["d2b-vue-container", "d2b-vue-" + name]\'></div>\n  ',props:{data:{default:function(){}},config:{default:function(){return function(){}}},duration:{default:500}},data:function(){return{unwatch:null}},computed:{properties:function(){return{generator:this.generator,data:this.data,config:this.config}}},destroyed:function(){e.selectAll(".d2b-tooltip").remove(),e.select(window).on("resize."+this.id,null)},mounted:function(){this.updateDefer(),e.select(window).on("resize."+this.id,this.updateDefer),this.watcher()},methods:{watcher:function(){var t=function(){this.unwatch&&this.unwatch(),this.update(),this.watcher()};this.unwatch=this.$watch("properties",t,{deep:!0})},update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("beforeRender",this.$el,this.generator);var n=this.data;this.config(this.generator);var r=e.select(this.$el),a=t.skipTransition?r:r.transition().duration(this.duration);r.datum(n),a.call(this.generator),this.$emit("rendered",this.$el,this.generator)},updateNow:function(){this.update({skipTransition:!0})},updateDefer:function(){setTimeout(this.updateNow,0)}}}),tt={mixins:[Z],props:{generator:{default:function(){return L()}}},data:function(){return{name:"axis-chart"}}},et={mixins:[Z],props:{generator:{default:function(){return S()}}},data:function(){return{name:"pie-chart"}}},nt={mixins:[Z],props:{generator:{default:function(){return N()}}},data:function(){return{name:"sunburst-chart"}}},rt={mixins:[Z],props:{generator:{default:function(){return D()}}},data:function(){return{name:"sankey-chart"}}};t.version=I,t.textWrap=i,t.textWrapPX=l,t.tweenArc=d,t.tweenNumber=u,t.tweenCentroid=s,t.tooltip=b,t.tooltipAxis=h,t.stack=f,t.breadcrumbs=g,t.legend=y,t.chartFrame=v,t.defaultColor=W,t.id=j,t.color=W,t.omit=m,t.mean=x,t.median=k,
t.mode=P,t.range=w,t.midpoint=F,t.toDegrees=_,t.toRadians=A,t.modelBase=p,t.symbolMars=H,t.symbolVenus=J,t.point=M,t.svgPie=z,t.svgLine=R,t.svgArea=C,t.svgScatter=G,t.svgBar=B,t.svgBubblePack=T,t.svgSunburst=O,t.svgSankey=X,t.plane=Y,t.chartPie=S,t.chartAxis=L,t.chartSunburst=N,t.chartSankey=D,t.vueGenMixin=Z,t.vueChartAxis=tt,t.vueChartPie=et,t.vueChartSunburst=nt,t.vueChartSankey=rt}(this.d2b=this.d2b||{},d3,d3);